var Je=Object.defineProperty;var Ye=(l,e,s)=>e in l?Je(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var ee=(l,e,s)=>Ye(l,typeof e!="symbol"?e+"":e,s);import{p as Ve,a as A,s as j,b as U,o as Ne,c as Le,u as oe,g as t,d as Ae,i as X,t as Ce,e as Fe,f as x,h as ke,j as Oe,k as O,l as R,m as E,n as k,q as fe,r as ge,v as L,w as ve,x as Se,y as ce,z as Ee,A as Xe,B as Pe,C as Ge,D as pe,E as $e}from"./external.DepRz0zj.js";const et=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var tt=Oe('<table class="vtlist-inner"><!><tbody><!></tbody></table> <!>',1),it=Oe('<div class="vtlist-inner"><!> <!> <!></div>'),nt=Oe("<div><!></div>");function dt(l,e){Ve(e,!0);var s;(function(i){i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED"})(s||(s={}));const r=A(e,"items",19,()=>[]),g=A(e,"isDisabled",3,!1),d=A(e,"isHorizontal",3,!1),v=A(e,"isTable",3,!1),q=A(e,"preRenderCount",3,6),T=A(e,"scrollToAlignment",19,()=>ae.AUTO),ue=A(e,"scrollToBehaviour",19,()=>We.INSTANT),ye=A(e,"class",3,""),Te=A(e,"style",3,""),Z=3;let K=!1,C=-1,F,b,W=j(0),P=j(0),Q=j(0),te=j(q()-1),B=j(0),V=j(U({offset:e.scrollToOffset||e.scrollToIndex!==void 0&&r().length&&p(e.scrollToIndex)&&1||0,scrollChangeReason:s.REQUESTED})),M;const G=L(()=>{var n;const i=(((n=r())==null?void 0:n.length)||1)-1;return t(te)<i?t(te):i}),ie=L(()=>new Array(r().length)),D=L(()=>r().map((i,n)=>{var u;let o=(u=e.sizingCalculator)==null?void 0:u.call(e,n,i);return o!==void 0||(o=t(ie)[n],o!==void 0)?o:t(B)})),y=L(()=>{const i=[];return t(D).reduce((n,o)=>(i.push(n),n+o),0),i}),ze=L(()=>{if(!r()||g())return[];const i=[];for(let n=t(Q);n<=t(G);(n+=1)-1){const o=r()[n];o&&i.push({item:o,index:n,size:t(D)[n]})}return i}),J=L(()=>t(y)[t(Q)]?t(y)[t(Q)]:0),ne=L(()=>t(y).length>0?t(y)[t(y).length-1]+t(D)[t(D).length-1]:0),le=L(()=>t(y)[t(G)]?t(ne)-t(y)[t(G)]-t(D)[t(G)]:0),re=L(()=>Pe(!g()&&"overflow:auto;",Te())),Ie=L(()=>Pe(!v()&&"display:flex;",!v()&&(!d()&&"flex-direction:column;"||"flex-direction:row;"),!g()&&(!d()&&`margin-top:${t(J)}px;margin-bottom:${t(le)}px`||`margin-left:${t(J)}px;margin-right:${t(le)}px;width:${t(ne)-t(le)-t(J)}px`)));Ne(()=>{F.addEventListener("scroll",N,et),Re(),e.scrollToOffset!==void 0?Me(e.scrollToOffset):e.scrollToIndex!==void 0&&Me(p(e.scrollToIndex)),K=!0}),Le(()=>{K&&F.removeEventListener("scroll",N)}),oe(()=>{e.scrollToIndex,T(),e.scrollToOffset,r().length,e.sizingCalculator,console.log("propUpdated"),h()}),oe(()=>{if(console.log("onVisibleRangeUpdate"),e.onVisibleRangeUpdate){const i=we(d()?t(P):t(W),t(V).offset);e.onVisibleRangeUpdate(i)}}),oe(()=>{const{offset:i,scrollChangeReason:n}=t(V);((M==null?void 0:M.offset)!==i||(M==null?void 0:M.scrollChangeReason)!==n)&&Re(),(M==null?void 0:M.offset)!==i&&n===s.REQUESTED&&Me(i),M=t(V)}),oe(()=>{console.log("component is resized "+t(W)+" "+t(P)),K&&z(0)});let a={scrollToIndex:e.scrollToIndex,scrollToAlignment:T(),scrollToOffset:e.scrollToOffset,modelCount:r().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:t(B)};function h(){if(!K)return;e.scrollToIndex&&e.scrollToOffset&&console.log("VirtualList: scrollToIndex and scrollToOffset MUST NOT be used together.");const i=a.scrollToIndex!==e.scrollToIndex||a.scrollToAlignment!==T(),n=a.modelCount!==r().length||a.sizingCalculator!==e.sizingCalculator||a.avgSizeInPx!==t(B);n&&z(),a.scrollToOffset!==e.scrollToOffset?O(V,U({offset:e.scrollToOffset||0,scrollChangeReason:s.REQUESTED})):typeof e.scrollToIndex=="number"&&(i||n)&&O(V,U({offset:p(e.scrollToIndex),scrollChangeReason:s.REQUESTED})),a={scrollToIndex:e.scrollToIndex,scrollToAlignment:T(),scrollToOffset:e.scrollToOffset,modelCount:r().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:t(B)}}function z(i=0){C=Math.min(C,i-1),Re()}function N(i){var o;const n=qe(F);i.target!==F||n<0||t(V).offset===n||(O(V,U({offset:n,scrollChangeReason:s.OBSERVED})),(o=e.onAfterScroll)==null||o.call(e,{offset:n,event:i}))}function p(i,n=T(),o=r().length){return i<0?i=0:i>=o&&(i=o-1),xe(n,d()?t(P):t(W),t(V).offset||0,i)}function xe(i=ae.START,n,o,u){if(n<=0)return 0;const m=t(D)[u],f=t(y)[u],S=f-n+m;let c;switch(i){case ae.END:c=S;break;case ae.CENTER:c=f-(n-m)/2;break;case ae.START:c=f;break;default:c=Math.max(S,Math.min(f,o))}const I=t(ne);return Math.max(0,Math.min(I-n,c))}function be(i){if(isNaN(i))throw Error(`Invalid offset ${i} specified`);i=Math.max(0,i);const n=H(),o=Math.max(0,C);return n.offset>=i?De(0,o,i):Be(o,i)}function H(){return C>=0?{offset:t(y)[C],size:t(D)[C]}:{offset:0,size:0}}function De(i,n,o){let u=0,m=0;for(;i<=n;){if(u=i+Math.floor((n-i)/2),m=t(y)[u],m===o)return u;m<o?i=u+1:m>o&&(n=u-1)}return i>0?i-1:0}function Be(i,n){let o=1;for(;i<r().length&&t(y)[i]<n;)i+=o,o*=2;return De(Math.floor(i/2),Math.min(i,r().length-1),n)}function Re(){t(B)||O(B,U(He()));const i=we(d()?t(P):t(W),t(V).offset,Z);O(Q,U(i.start)),O(te,U(i.end));let n=0;const o={},u=v()?b.querySelector("tbody").children:b.children;for(let m=0;m<u.length;(m+=1)-1){const f=u[m],S=getComputedStyle(f),c=S.position;if(c&&["absolute","fixed"].includes(c))continue;const I=S.display!=="none"?Ue(f):0,_=t(Q)+n;o[_]=(o[_]||0)+I,n+=1}for(const m of Object.keys(o)){const f=parseInt(m);t(ie)[f]!==o[f]&&(t(ie)[f]=o[f])}}function He(){const n=[],o=v()?b.querySelector("tbody").children:b.children;for(let u=0;u<o.length;(u+=1)-1){const m=o[u],f=getComputedStyle(m);if(["absolute","fixed"].includes(f.position))continue;const S=Ue(m);if(n.push(S),n.length>=10)break}return n.length===0?0:n.reduce((u,m)=>u+m,0)/n.length}function je(i){const n=getComputedStyle(i);let o=parseFloat(d()?n.width:n.height);return n.boxSizing==="border-box"&&(d()?o-=parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth):o-=parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth)),o}function we(i=0,n,o=0){if(t(ne)===0)return{start:0,end:0};const m=n+i;let f=be(n);if(f===void 0)throw Error(`Invalid offset ${n} specified`);let S=t(y)[f]+t(D)[f],c=f;for(;S<m&&c<r().length-1;)c+=1,S+=t(D)[c];return o>0&&(f=Math.max(0,f-o),c=Math.min(c+o,r().length-1)),{start:f,end:c}}function Ue(i){const n=getComputedStyle(i);let o=je(i);return d()?o+=parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth)+parseFloat(n.marginLeft)+parseFloat(n.marginRight):o+=parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth)+parseFloat(n.marginTop)+parseFloat(n.marginBottom),Number.isNaN(o)?0:o}function qe(i){return d()?i.scrollLeft:i.scrollTop}function Me(i){if("scroll"in F){const n={behavior:ue()};n[d()?"left":"top"]=i,F.scroll(n)}else F[d()?"scrollLeft":"scrollTop"]=i}var $=nt();Ae($,i=>F=i,()=>F);const Ze=L(()=>Pe("vtlist",ye()));var Ke=ve($);X(Ke,v,i=>{var n=tt(),o=E(n);Ae(o,c=>b=c,()=>b);var u=ve(o);X(u,()=>e.header,c=>{var I=R(),_=E(I);k(_,()=>e.header),x(c,I)});var m=fe(u),f=ve(m);X(f,g,c=>{var I=R(),_=E(I);ge(_,17,r,Se,(Y,se)=>{var me=R(),_e=E(me);k(_e,()=>e.vl_slot,()=>t(se)),x(Y,me)}),x(c,I)},c=>{var I=R(),_=E(I);ge(_,17,()=>t(ze),Se,(Y,se)=>{var me=R(),_e=E(me);k(_e,()=>e.vl_slot,()=>t(se)),x(Y,me)}),x(c,I)}),ce(m),ce(o);var S=fe(o,2);X(S,()=>e.footer,c=>{var I=R(),_=E(I);k(_,()=>e.footer),x(c,I)}),Ce(()=>Ee(o,"style",t(Ie))),x(i,n)},i=>{var n=it();Ae(n,f=>b=f,()=>b);var o=ve(n);X(o,()=>e.header,f=>{var S=R(),c=E(S);k(c,()=>e.header),x(f,S)});var u=fe(o,2);X(u,g,f=>{var S=R(),c=E(S);ge(c,17,r,Se,(I,_)=>{var Y=R(),se=E(Y);k(se,()=>e.vl_slot,()=>t(_)),x(I,Y)}),x(f,S)},f=>{var S=R(),c=E(S);ge(c,17,()=>t(ze),Se,(I,_)=>{var Y=R(),se=E(Y);k(se,()=>e.vl_slot,()=>t(_)),x(I,Y)}),x(f,S)});var m=fe(u,2);X(m,()=>e.footer,f=>{var S=R(),c=E(S);k(c,()=>e.footer),x(f,S)}),ce(n),Ce(()=>Ee(n,"style",t(Ie))),x(i,n)}),ce($),Ce(()=>{Xe($,t(Ze)),Ee($,"style",t(re))}),Fe($,"clientHeight",i=>O(W,i)),Fe($,"clientWidth",i=>O(P,i)),x(l,$),ke()}var We=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(We||{}),ae=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(ae||{});class st{constructor(e,s,r,g){ee(this,"model");ee(this,"modelCount");ee(this,"itemSize");ee(this,"estimatedItemSize");ee(this,"itemSizeAndPositionData");ee(this,"lastMeasuredIndex");ee(this,"totalSize");this.model=e,this.itemSize=r,this.modelCount=s,this.estimatedItemSize=g,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,s,r){s!==void 0&&(this.modelCount=s),r!==void 0&&(this.estimatedItemSize=r),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:s}=this;return typeof s=="function"?s(this.model[e],e):Array.isArray(s)?s[e]:s}computeTotalSizeAndPositionData(){let e=0;for(let s=0;s<this.modelCount;s++){const r=this.getSize(s);this.itemSizeAndPositionData[s]={offset:e,size:r},e+=r}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.modelCount)throw Error(`Requested index ${e} is outside of range 0..${this.modelCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const s=this.getSizeAndPositionOfLastMeasuredItem();let r=s.offset+s.size;for(let g=this.lastMeasuredIndex+1;g<=e;g++){const d=this.getSize(g);if(d===void 0||isNaN(d))throw Error(`Invalid size returned for index ${g} of value ${d}`);this.itemSizeAndPositionData[g]={offset:r,size:d},r+=d}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=he.START,s,r,g){if(s<=0)return 0;const d=this.getSizeAndPositionForIndex(g),v=d.offset,q=v-s+d.size;let T;switch(e){case he.END:T=q;break;case he.CENTER:T=v-(s-d.size)/2;break;case he.START:T=v;break;default:T=Math.max(q,Math.min(v,r))}const ue=this.getTotalSize();return Math.max(0,Math.min(ue-s,T))}getVisibleRange(e=0,s,r){if(this.getTotalSize()===0)return{start:0,end:0};const d=s+e;let v=this.findNearestItem(s);if(v===void 0)throw Error(`Invalid offset ${s} specified`);const q=this.getSizeAndPositionForIndex(v);s=q.offset+q.size;let T=v;for(;s<d&&T<this.modelCount-1;)T++,s+=this.getSizeAndPositionForIndex(T).size;return r&&(v=Math.max(0,v-r),T=Math.min(T+r,this.modelCount-1)),{start:v,end:T}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const s=this.getSizeAndPositionOfLastMeasuredItem(),r=Math.max(0,this.lastMeasuredIndex);return s.offset>=e?this.binarySearch(0,r,e):this.exponentialSearch(r,e)}binarySearch(e,s,r){let g=0,d=0;for(;e<=s;){if(g=e+Math.floor((s-e)/2),d=this.getSizeAndPositionForIndex(g).offset,d===r)return g;d<r?e=g+1:d>r&&(s=g-1)}return e>0?e-1:0}exponentialSearch(e,s){let r=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<s;)e+=r,r*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),s)}}const ot=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var lt=Oe('<div><!> <div class="virtual-list-inner svelte-f32i87"></div> <!></div>');function ft(l,e){Ve(e,!0);const s=A(e,"width",3,"100%"),r=A(e,"model",19,()=>[]),g=A(e,"windowOverPadding",3,3),d=A(e,"scrollDirection",19,()=>w.VERTICAL),v=A(e,"scrollToAlignment",19,()=>he.AUTO),q=A(e,"scrollToBehaviour",19,()=>Qe.INSTANT),T=A(e,"class",3,"");A(e,"style",3,"");const ue=pe(e,["$$slots","$$events","$$legacy","height","width","model","modelCount","itemSize","estimatedItemSize","getKey","scrollToIndex","scrollOffset","windowOverPadding","scrollDirection","scrollToAlignment","scrollToBehaviour","footer","slot","header","onVisibleRangeUpdate","onAfterScroll","class","style"]),ye={[w.VERTICAL]:"top",[w.HORIZONTAL]:"left"},Te={[w.VERTICAL]:"scrollTop",[w.HORIZONTAL]:"scrollLeft"},Z=new st(r(),e.modelCount,e.itemSize,e.estimatedItemSize);let K=!1,C,F=j(U([])),b=j(U({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&D(e.scrollToIndex)||0,scrollChangeReason:de.REQUESTED})),W={},P={scrollToIndex:e.scrollToIndex,scrollToAlignment:v(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},Q={},te=j(""),B=j("");oe(()=>{e.scrollToIndex,v(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,V()}),oe(()=>{const{offset:a,scrollChangeReason:h}=t(b);(W.offset!==a||W.scrollChangeReason!==h)&&M(),W.offset!==a&&h===de.REQUESTED&&G(a),W=t(b)}),oe(()=>{e.height,s(),K&&ie(0)}),(()=>{if(d()===w.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(d()===w.HORIZONTAL&&typeof s()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");M()})(),Ne(()=>{C.addEventListener("scroll",y,ot),e.scrollOffset!==void 0?G(e.scrollOffset):e.scrollToIndex!==void 0&&G(D(e.scrollToIndex)),K=!0}),Le(()=>{K&&C.removeEventListener("scroll",y)});function V(){if(!K)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset MUST NOT be used together.");const a=P.scrollToIndex!==e.scrollToIndex||P.scrollToAlignment!==v(),h=P.modelCount!==e.modelCount||P.itemSize!==e.itemSize||P.estimatedItemSize!==e.estimatedItemSize;h&&(Z.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),ie()),P.scrollOffset!==e.scrollOffset?O(b,U({offset:e.scrollOffset||0,scrollChangeReason:de.REQUESTED})):typeof e.scrollToIndex=="number"&&(a||h)&&O(b,U({offset:D(e.scrollToIndex,v(),e.modelCount),scrollChangeReason:de.REQUESTED})),P={scrollToIndex:e.scrollToIndex,scrollToAlignment:v(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function M(){const{offset:a}=t(b);let{start:h,end:z}=Z.getVisibleRange(d()===w.VERTICAL?e.height:s(),a,g()),N=[];const p=Z.getTotalSize(),xe=typeof e.height=="number"?"px":"",be=typeof s()=="number"?"px":"";if(d()===w.VERTICAL?(O(te,`height:${e.height}${xe};width:${s()}${be};`),O(B,`flex-direction:column;height:${p}px;`)):(O(te,`height:${e.height}${xe};width:${s()}${be};`),O(B,`min-height:100%;width:${p}px;`)),h!==void 0&&z!==void 0){for(let H=h;H<=z;(H+=1)-1)N.push({item:r()[H],index:H,style:ze(H)});if(e.onVisibleRangeUpdate){const H=Z.getVisibleRange(d()===w.VERTICAL?e.height:s(),a,0);e.onVisibleRangeUpdate({type:"range.update",start:H.start,end:H.end})}}O(F,U(N))}function G(a){"scroll"in C?C.scroll({[ye[d()]]:a,behavior:q()}):C[Te[d()]]=a}function ie(a=0){Q={},Z.resetItem(a),M()}function D(a,h=v(),z=e.modelCount){return a<0?a=0:a>=z&&(a=z-1),Z.getUpdatedOffsetForIndex(h,d()===w.VERTICAL?e.height:s(),t(b).offset||0,a)}const y=a=>{const h=C[Te[d()]];h<0||t(b).offset===h||a.target!==C||(O(b,U({offset:h,scrollChangeReason:de.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:h,event:a}))};function ze(a){if(Q[a])return Q[a];const{size:h,offset:z}=Z.getSizeAndPositionForIndex(a);let N;return d()===w.VERTICAL?N=`left:0;width:100%;height:${h}px;position:absolute;top:${z}px;`:N=`top:0;width:${h}px;position:absolute;height:100%;left:${z}px;`,Q[a]=N}var J=lt();Ae(J,a=>C=a,()=>C);let ne;var le=ve(J);X(le,()=>e.header,a=>{var h=R(),z=E(h);k(z,()=>e.header),x(a,h)});var re=fe(le,2);ge(re,21,()=>t(F),Se,(a,h)=>{var z=R(),N=E(z),p=$e(()=>({item:t(h).item,style:t(h).style,index:e.getKey?e.getKey(t(h).index):t(h).index}));k(N,()=>e.slot,()=>t(p)),x(a,z)}),ce(re);var Ie=fe(re,2);return X(Ie,()=>e.footer,a=>{var h=R(),z=E(h);k(z,()=>e.footer),x(a,h)}),ce(J),Ce(()=>{ne=Ge(J,ne,{class:`virtual-list-wrapper $${T()??""}`,style:t(te),...ue},"svelte-f32i87"),Ee(re,"style",t(B))}),x(l,J),ke({recomputeSizes:ie})}var Qe=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Qe||{}),he=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(he||{}),w=(l=>(l.HORIZONTAL="horizontal",l.VERTICAL="vertical",l))(w||{}),de=(l=>(l[l.OBSERVED=0]="OBSERVED",l[l.REQUESTED=1]="REQUESTED",l))(de||{});export{ae as A,We as S,dt as V,he as a,Qe as b,ft as c};
