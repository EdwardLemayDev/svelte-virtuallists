var oe=Object.defineProperty;var ae=(s,e,t)=>e in s?oe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var x=(s,e,t)=>ae(s,typeof e!="symbol"?e+"":e,t);import{p as re,a as P,s as w,b as C,u as q,o as le,c as de,g,d as T,e as fe,i as p,f as he,t as ue,h as D,j as ce,k as me,l as V,m as $,n as Se,q as H,r as Z,v as L,w as B}from"./external.snEXkSWD.js";class ze{constructor(e,t,n){x(this,"itemSize");x(this,"itemCount");x(this,"estimatedItemSize");x(this,"itemSizeAndPositionData");x(this,"lastMeasuredIndex");x(this,"totalSize");this.itemSize=e,this.itemCount=t,this.estimatedItemSize=n,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.itemCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.itemCount;t++){const n=this.getSize(t),a=e;e+=n,this.itemSizeAndPositionData[t]={offset:a,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let a=this.lastMeasuredIndex+1;a<=e;a++){const l=this.getSize(a);if(l===void 0||isNaN(l))throw Error(`Invalid size returned for index ${a} of value ${l}`);this.itemSizeAndPositionData[a]={offset:n,size:l},n+=l}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex(e=M.START,t,n,a){if(t<=0)return 0;const l=this.getSizeAndPositionForIndex(a),r=l.offset,u=r-t+l.size;let d;switch(e){case M.END:d=u;break;case M.CENTER:d=r-(t-l.size)/2;break;case M.START:d=r;break;default:d=Math.max(u,Math.min(r,n))}const m=this.getTotalSize();return Math.max(0,Math.min(m-t,d))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const l=t+e;let r=this.findNearestItem(t);if(r===void 0)throw Error(`Invalid offset ${t} specified`);const u=this.getSizeAndPositionForIndex(r);t=u.offset+u.size;let d=r;for(;t<l&&d<this.itemCount-1;)d++,t+=this.getSizeAndPositionForIndex(d).size;return n&&(r=Math.max(0,r-n),d=Math.min(d+n,this.itemCount-1)),{start:r,end:d}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let a=0,l=0;for(;e<=t;){if(a=e+Math.floor((t-e)/2),l=this.getSizeAndPositionForIndex(a).offset,l===n)return a;l<n?e=a+1:l>n&&(t=a-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.itemCount-1),t)}}var ge=me('<div class="virtual-list-wrapper svelte-1qhxbsx"><!> <div class="virtual-list-inner svelte-1qhxbsx"></div> <!></div>');const Ie=(()=>{let s=!1;try{const e=Object.defineProperty({},"passive",{get(){return s={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return s})();function Ae(s,e){re(e,!0);const t={[h.VERTICAL]:"top",[h.HORIZONTAL]:"left"},n={[h.VERTICAL]:"scrollTop",[h.HORIZONTAL]:"scrollLeft"},a=P(e,"width",3,"100%"),l=P(e,"windowOverPadding",3,3),r=P(e,"scrollDirection",11,()=>h.VERTICAL),u=P(e,"scrollToAlignment",11,()=>M.AUTO),d=P(e,"scrollToBehaviour",11,()=>ee.INSTANT),m=new ze(e.itemSize,e.itemCount,W());let O=!1,S,J=w(C([])),z=w(C({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.itemCount&&Q(e.scrollToIndex)||0,scrollChangeReason:E.REQUESTED})),y={},v={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,itemCount:e.itemCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},b={},U=w(""),F=w("");q(()=>{e.scrollToIndex,u(),e.scrollOffset,e.itemCount,e.itemSize,e.estimatedItemSize,te()}),q(()=>{g(z),ie()}),q(()=>{e.height,a(),O&&j(0)}),(()=>{if(r()===h.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(r()===h.HORIZONTAL&&typeof a()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");k()})(),le(()=>{S.addEventListener("scroll",K,Ie),e.scrollOffset!==void 0?_(e.scrollOffset):e.scrollToIndex!==void 0&&_(Q(e.scrollToIndex)),O=!0}),de(()=>{O&&S.removeEventListener("scroll",K)});function te(){if(!O)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const i=v.scrollToIndex!==e.scrollToIndex||v.scrollToAlignment!==u(),o=v.itemCount!==e.itemCount||v.itemSize!==e.itemSize||v.estimatedItemSize!==e.estimatedItemSize;o&&(m.updateConfig(e.itemSize,e.itemCount,W()),j()),v.scrollOffset!==e.scrollOffset?T(z,C({offset:e.scrollOffset||0,scrollChangeReason:E.REQUESTED})):typeof e.scrollToIndex=="number"&&(i||o)&&T(z,C({offset:Q(e.scrollToIndex,u(),e.itemCount),scrollChangeReason:E.REQUESTED})),v={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,itemCount:e.itemCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function ie(){if(!O)return;const{offset:i,scrollChangeReason:o}=g(z);(y.offset!==i||y.scrollChangeReason!==o)&&k(),y.offset!==i&&o===E.REQUESTED&&_(i),y=g(z)}function k(){const{offset:i}=g(z);let{start:o,end:f}=m.getVisibleRange(r()===h.VERTICAL?e.height:a(),i,l()),I=[];const c=m.getTotalSize(),X=typeof e.height=="number"?"px":"",G=typeof a()=="number"?"px":"";if(r()===h.VERTICAL?(T(U,`height:${e.height}${X};width:${a()}${G};`),T(F,`flex-direction:column;height:${c}px;`)):(T(U,`height:${e.height}${X};width:${a()}${G};`),T(F,`min-height:100%;width:${c}px;`)),o!==void 0&&f!==void 0){for(let A=o;A<=f;A++)I.push({index:A,style:se(A)});if(e.onVisibleRangeUpdate){const A=m.getVisibleRange(r()===h.VERTICAL?e.height:a(),i,0);e.onVisibleRangeUpdate({type:"range.update",start:A.start,end:A.end})}}T(J,C(I))}function _(i){"scroll"in S?S.scroll({[t[r()]]:i,behavior:d()}):S[n[r()]]=i}function j(i=0){b={},m.resetItem(i),k()}function Q(i,o=u(),f=e.itemCount){return i<0?i=0:i>=f&&(i=f-1),m.getUpdatedOffsetForIndex(o,r()===h.VERTICAL?e.height:a(),g(z).offset||0,i)}const K=i=>{const o=S[n[r()]];o<0||g(z).offset===o||i.target!==S||(T(z,C({offset:o,scrollChangeReason:E.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:o,event:i}))};function W(){return e.estimatedItemSize||typeof e.itemSize=="number"&&e.itemSize||50}function se(i,o){if(b[i])return b[i];const{size:f,offset:I}=m.getSizeAndPositionForIndex(i);let c;return r()===h.VERTICAL?(c=`left:0;width:100%;height:${f}px;`,c+=`position:absolute;top:${I}px;`):(c=`top:0;width:${f}px;`,c+=`position:absolute;height:100%;left:${I}px;`),b[i]=c}var R=ge();fe(R,i=>S=i,()=>S);var Y=Se(R);p(Y,()=>e.header,i=>{var o=H(),f=B(o);Z(()=>e.header,f),D(i,o)});var N=L(L(Y,!0));he(N,77,()=>g(J),(i,o)=>e.getKey?e.getKey(V(i).index):V(i).index,(i,o,f)=>{var I=H(),c=B(I);Z(()=>e.row,c,()=>({style:V(o).style,index:V(o).index})),D(i,I)});var ne=L(L(N,!0));return p(ne,()=>e.footer,i=>{var o=H(),f=B(o);Z(()=>e.footer,f),D(i,o)}),ue(()=>{$(R,"style",g(U)),$(N,"style",g(F))}),D(s,R),ce({recomputeSizes:j})}var ee=(s=>(s.AUTO="auto",s.SMOOTH="smooth",s.INSTANT="instant",s))(ee||{}),M=(s=>(s.AUTO="auto",s.START="start",s.CENTER="center",s.END="end",s))(M||{}),h=(s=>(s.HORIZONTAL="horizontal",s.VERTICAL="vertical",s))(h||{}),E=(s=>(s[s.OBSERVED=0]="OBSERVED",s[s.REQUESTED=1]="REQUESTED",s))(E||{});export{M as A,h as D,ee as S,Ae as V};
