var Be=Object.defineProperty;var ke=(r,e,t)=>e in r?Be(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $=(r,e,t)=>ke(r,typeof e!="symbol"?e+"":e,t);import{p as De,a as b,s as j,b as k,u as xe,o as Fe,c as Ve,g as i,d as O,e as ye,i as K,f as ze,t as Ae,h as g,j as Ue,k as Ce,l as ue,m as Ie,n as Te,r as he,q as We,v as Ee,w as He,x as _,y as E,z as B,A as Qe,B as we,C as N,D as je,E as Oe}from"./external.CLekpqux.js";class qe{constructor(e,t,o,c){$(this,"model");$(this,"modelCount");$(this,"itemSize");$(this,"estimatedItemSize");$(this,"itemSizeAndPositionData");$(this,"lastMeasuredIndex");$(this,"totalSize");this.model=e,this.itemSize=o,this.modelCount=t,this.estimatedItemSize=c,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,o){t!==void 0&&(this.modelCount=t),o!==void 0&&(this.estimatedItemSize=o),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(this.model[e],e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const o=this.getSize(t);this.itemSizeAndPositionData[t]={offset:e,size:o},e+=o}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.modelCount)throw Error(`Requested index ${e} is outside of range 0..${this.modelCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let o=t.offset+t.size;for(let c=this.lastMeasuredIndex+1;c<=e;c++){const d=this.getSize(c);if(d===void 0||isNaN(d))throw Error(`Invalid size returned for index ${c} of value ${d}`);this.itemSizeAndPositionData[c]={offset:o,size:d},o+=d}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=re.START,t,o,c){if(t<=0)return 0;const d=this.getSizeAndPositionForIndex(c),u=d.offset,I=u-t+d.size;let h;switch(e){case re.END:h=I;break;case re.CENTER:h=u-(t-d.size)/2;break;case re.START:h=u;break;default:h=Math.max(I,Math.min(u,o))}const W=this.getTotalSize();return Math.max(0,Math.min(W-t,h))}getVisibleRange(e=0,t,o){if(this.getTotalSize()===0)return{start:0,end:0};const d=t+e;let u=this.findNearestItem(t);if(u===void 0)throw Error(`Invalid offset ${t} specified`);const I=this.getSizeAndPositionForIndex(u);t=I.offset+I.size;let h=u;for(;t<d&&h<this.modelCount-1;)h++,t+=this.getSizeAndPositionForIndex(h).size;return o&&(u=Math.max(0,u-o),h=Math.min(h+o,this.modelCount-1)),{start:u,end:h}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),o=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,o,e):this.exponentialSearch(o,e)}binarySearch(e,t,o){let c=0,d=0;for(;e<=t;){if(c=e+Math.floor((t-e)/2),d=this.getSizeAndPositionForIndex(c).offset,d===o)return c;d<o?e=c+1:d>o&&(t=c-1)}return e>0?e-1:0}exponentialSearch(e,t){let o=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=o,o*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}const Ze=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var Ke=Ce('<div><!> <div class="virtual-list-inner svelte-f32i87"></div> <!></div>');function et(r,e){De(e,!0);const t=b(e,"width",3,"100%"),o=b(e,"model",19,()=>[]),c=b(e,"windowOverPadding",3,3),d=b(e,"scrollDirection",19,()=>F.VERTICAL),u=b(e,"scrollToAlignment",19,()=>re.AUTO),I=b(e,"scrollToBehaviour",19,()=>Pe.INSTANT),h=b(e,"class",3,"");b(e,"style",3,"");const W=He(e,["$$slots","$$events","$$legacy","height","width","model","modelCount","itemSize","estimatedItemSize","getKey","scrollToIndex","scrollOffset","windowOverPadding","scrollDirection","scrollToAlignment","scrollToBehaviour","footer","slot","header","onVisibleRangeUpdate","onAfterScroll","class","style"]),V={[F.VERTICAL]:"top",[F.HORIZONTAL]:"left"},J={[F.VERTICAL]:"scrollTop",[F.HORIZONTAL]:"scrollLeft"},q=new qe(o(),e.modelCount,e.itemSize,e.estimatedItemSize);let le=!1,P,H=j(k([])),w=j(k({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&te(e.scrollToIndex)||0,scrollChangeReason:fe.REQUESTED})),Y={},M={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},C={},X=j(""),G=j("");xe(()=>{e.scrollToIndex,u(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,ae()}),xe(()=>{const{offset:a,scrollChangeReason:f}=i(w);(Y.offset!==a||Y.scrollChangeReason!==f)&&D(),Y.offset!==a&&f===fe.REQUESTED&&ee(a),Y=i(w)}),xe(()=>{e.height,t(),le&&de(0)}),(()=>{if(d()===F.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(d()===F.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");D()})(),Fe(()=>{P.addEventListener("scroll",me,Ze),e.scrollOffset!==void 0?ee(e.scrollOffset):e.scrollToIndex!==void 0&&ee(te(e.scrollToIndex)),le=!0}),Ve(()=>{le&&P.removeEventListener("scroll",me)});function ae(){if(!le)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset MUST NOT be used together.");const a=M.scrollToIndex!==e.scrollToIndex||M.scrollToAlignment!==u(),f=M.modelCount!==e.modelCount||M.itemSize!==e.itemSize||M.estimatedItemSize!==e.estimatedItemSize;f&&(q.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),de()),M.scrollOffset!==e.scrollOffset?O(w,k({offset:e.scrollOffset||0,scrollChangeReason:fe.REQUESTED})):typeof e.scrollToIndex=="number"&&(a||f)&&O(w,k({offset:te(e.scrollToIndex,u(),e.modelCount),scrollChangeReason:fe.REQUESTED})),M={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function D(){const{offset:a}=i(w);let{start:f,end:v}=q.getVisibleRange(d()===F.VERTICAL?e.height:t(),a,c()),U=[];const ne=q.getTotalSize(),ce=typeof e.height=="number"?"px":"",ve=typeof t()=="number"?"px":"";if(d()===F.VERTICAL?(O(X,`height:${e.height}${ce};width:${t()}${ve};`),O(G,`flex-direction:column;height:${ne}px;`)):(O(X,`height:${e.height}${ce};width:${t()}${ve};`),O(G,`min-height:100%;width:${ne}px;`)),f!==void 0&&v!==void 0){for(let Q=f;Q<=v;(Q+=1)-1)U.push({item:o()[Q],index:Q,style:y(Q)});if(e.onVisibleRangeUpdate){const Q=q.getVisibleRange(d()===F.VERTICAL?e.height:t(),a,0);e.onVisibleRangeUpdate({type:"range.update",start:Q.start,end:Q.end})}}O(H,k(U))}function ee(a){"scroll"in P?P.scroll({[V[d()]]:a,behavior:I()}):P[J[d()]]=a}function de(a=0){C={},q.resetItem(a),D()}function te(a,f=u(),v=e.modelCount){return a<0?a=0:a>=v&&(a=v-1),q.getUpdatedOffsetForIndex(f,d()===F.VERTICAL?e.height:t(),i(w).offset||0,a)}const me=a=>{const f=P[J[d()]];f<0||i(w).offset===f||a.target!==P||(O(w,k({offset:f,scrollChangeReason:fe.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:f,event:a}))};function y(a){if(C[a])return C[a];const{size:f,offset:v}=q.getSizeAndPositionForIndex(a);let U;return d()===F.VERTICAL?U=`left:0;width:100%;height:${f}px;position:absolute;top:${v}px;`:U=`top:0;width:${f}px;position:absolute;height:100%;left:${v}px;`,C[a]=U}var R=Ke();ye(R,a=>P=a,()=>P);let be;var ge=Ie(R);K(ge,()=>e.header,a=>{var f=_(),v=E(f);B(v,()=>e.header),g(a,f)});var ie=ue(ge,2);ze(ie,21,()=>i(H),Te,(a,f)=>{var v=_(),U=E(v),ne=Qe(()=>({item:i(f).item,style:i(f).style,index:e.getKey?e.getKey(i(f).index):i(f).index}));B(U,()=>e.slot,()=>i(ne)),g(a,v)}),he(ie);var _e=ue(ie,2);return K(_e,()=>e.footer,a=>{var f=_(),v=E(f);B(v,()=>e.footer),g(a,f)}),he(R),Ae(()=>{be=We(R,be,{class:`virtual-list-wrapper $${h()??""}`,style:i(X),...W},"svelte-f32i87"),Ee(ie,"style",i(G))}),g(r,R),Ue({recomputeSizes:de})}var Pe=(r=>(r.AUTO="auto",r.SMOOTH="smooth",r.INSTANT="instant",r))(Pe||{}),re=(r=>(r.AUTO="auto",r.START="start",r.CENTER="center",r.END="end",r))(re||{}),F=(r=>(r.HORIZONTAL="horizontal",r.VERTICAL="vertical",r))(F||{}),fe=(r=>(r[r.OBSERVED=0]="OBSERVED",r[r.REQUESTED=1]="REQUESTED",r))(fe||{});function Me(r,e,t={}){t={start:0,end:r.length-1,maxTimes:1e3,...t};let o=t.start,c=t.end;const d=t.returnNearestIfNoHit,u=t.maxTimes;let I,h;o||(o=0,c=r.length-1);let W=0,V=0;for(;o>=0&&o<=c;){if(W>=u)throw Error(`binarySearch: loop times is over ${u}, you can increase the limit.`);I=Math.floor((c-o)/2+o),h=r[I];const J=W+1;if(V=e(h,I,J),V>0)c=I-1;else if(V<0)o=I+1;else return{index:I,value:h,count:J,hit:!0};W++}return d?{index:I,value:h,count:W+1,hit:!1,greater:V>0}:null}const Je=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var Ye=Ce('<table class="vtlist-inner"><!><tbody><!></tbody></table> <!>',1),Xe=Ce('<div class="vtlist-inner"><!> <!> <!></div>'),Ge=Ce("<div><!></div>");function tt(r,e){De(e,!0);const t=b(e,"items",19,()=>[]),o=b(e,"isDisabled",3,!1),c=b(e,"isHorizontal",3,!1),d=b(e,"isTable",3,!1),u=b(e,"preRenderCount",3,6);b(e,"scrollToAlignment",19,()=>re.AUTO);const I=b(e,"scrollToBehaviour",19,()=>Pe.INSTANT),h=b(e,"class",3,""),W=b(e,"style",3,"");var V;(function(s){s[s.OBSERVED=0]="OBSERVED",s[s.REQUESTED=1]="REQUESTED"})(V||(V={}));let J=!1,q=j(0),le=j(0),P=100,H=j(0),w=j(u()-1),Y=j(0),M=j(k({offset:e.scrollOffset||e.scrollToIndex!==void 0&&1||0,scrollChangeReason:V.REQUESTED})),C;const X=N(()=>{var n;const s=(((n=t())==null?void 0:n.length)||1)-1;return i(w)<s?i(w):s}),G=N(()=>new Array(t().length)),ae=N(()=>t().map((n,l)=>i(G)[l]!=null?i(G)[l]:i(Y))),D=N(()=>{const s=[];return i(ae).reduce((n,l)=>(s.push(n),n+l),0),s}),ee=N(()=>i(D)[i(H)]?i(D)[i(H)]:0),de=N(()=>i(D).length>0?i(D)[i(D).length-1]+i(ae)[i(ae).length-1]:0),te=N(()=>i(D)[i(X)]?i(de)-i(D)[i(X)]-i(ae)[i(X)]:0);Fe(()=>{y.addEventListener("scroll",ie,Je),J=!0,f()}),Ve(()=>{J&&y.removeEventListener("scroll",ie)});const me=N(()=>{if(!t()||o())return;const s=[];for(let n=i(H);n<=i(X);(n+=1)-1){const l=t()[n];if(!l)break;s.push({item:l,index:i(H)+n})}return s});let y,R;const be=N(()=>Oe(!o()&&"overflow:auto;",W())),ge=N(()=>Oe(!d()&&"display:flex;",!d()&&(!c()&&"flex-direction:column;"||"flex-direction:row;"),!o()&&(!c()&&`margin-top:${i(ee)}px;margin-bottom:${i(te)}px`||`margin-left:${i(ee)}px;margin-right:${i(te)}px;width:${i(de)-i(te)-i(ee)}px`)));xe(()=>{const{offset:s,scrollChangeReason:n}=i(M);((C==null?void 0:C.offset)!==s||(C==null?void 0:C.scrollChangeReason)!==n)&&f(),(C==null?void 0:C.offset)!==s&&n===V.REQUESTED&&Q(s),C=i(M)}),xe(()=>{var s;return(s=e.onVisibleRangeUpdate)==null?void 0:s.call(e,{type:"range.update",start:i(H),end:i(w)})});function ie(s){var l;const n=ce(y);s.target!==y||n<0||i(M).offset===n||P-Math.abs(n-i(M).offset)>=1||(O(M,k({offset:n,scrollChangeReason:V.OBSERVED})),(l=e.onAfterScroll)==null||l.call(e,{type:"scroll.update",offset:n,event:s}))}function _e(){const s=ce(y)-ve(y)-P;return Me(i(D),l=>l-s,{returnNearestIfNoHit:!0}).index}function a(){const s=ce(y)-ve(y)+U(y)+P;return Me(i(D),l=>l-s,{returnNearestIfNoHit:!0}).index}function f(){console.log("updatePositions"),i(Y)||O(Y,k(v())),O(H,k(_e())),O(w,k(a()));let s=0;const n={},l=d()?R.querySelector("tbody").children:R.children;for(let T=0;T<l.length;(T+=1)-1){const x=l[T],A=getComputedStyle(x),S=A.position;if(S&&["absolute","fixed"].includes(S))continue;const m=A.display!=="none"?ne(x):0,z=i(H)+s;n[z]=(n[z]||0)+m,s+=1}for(const T of Object.keys(n)){const x=parseInt(T);i(G)[x]!==n[x]&&(i(G)[x]=n[x])}}function v(){const n=[],l=d()?R.querySelector("tbody").children:R.children;for(let T=0;T<l.length;(T+=1)-1){const x=l[T],A=getComputedStyle(x);if(["absolute","fixed"].includes(A.position))continue;const S=ne(x);if(n.push(S),n.length>=10)break}return n.length===0?0:n.reduce((T,x)=>T+x,0)/n.length}function U(s){const n=getComputedStyle(s);let l=parseFloat(c()?n.width:n.height);return n.boxSizing==="border-box"&&(c()?l-=parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth):l-=parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth)),l}function ne(s){const n=getComputedStyle(s);let l=U(s);return c()?l+=parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth)+parseFloat(n.marginLeft)+parseFloat(n.marginRight):l+=parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth)+parseFloat(n.marginTop)+parseFloat(n.marginBottom),Number.isNaN(l)?0:l}function ce(s){return c()?s.scrollLeft:s.scrollTop}function ve(s){const n=getComputedStyle(s);return c()?parseFloat(n.paddingLeft):parseFloat(n.paddingTop)}function Q(s){if("scroll"in y){const n={behavior:I()};n[c()?"left":"top"]=s,y.scroll(n)}else y[c()?"scrollLeft":"scrollTop"]=s}var p=Ge();ye(p,s=>y=s,()=>y);const Le=N(()=>Oe("vtlist",h()));var Ne=Ie(p);K(Ne,d,s=>{var n=Ye(),l=E(n);ye(l,m=>R=m,()=>R);var T=Ie(l);K(T,()=>e.header,m=>{var z=_(),L=E(z);B(L,()=>e.header),g(m,z)});var x=ue(T),A=Ie(x);K(A,o,m=>{var z=_(),L=E(z);ze(L,17,t,Te,(se,Z,oe)=>{var Se=_(),Re=E(Se);B(Re,()=>e.vl_slot,()=>({item:i(Z).item,index:oe})),g(se,Se)}),g(m,z)},m=>{var z=_(),L=E(z);ze(L,17,()=>i(me),Te,(se,Z,oe)=>{var Se=_(),Re=E(Se);B(Re,()=>e.vl_slot,()=>({item:i(Z).item,index:oe})),g(se,Se)}),g(m,z)}),he(x),he(l);var S=ue(l,2);K(S,()=>e.footer,m=>{var z=_(),L=E(z);B(L,()=>e.footer),g(m,z)}),Ae(()=>Ee(l,"style",i(ge))),g(s,n)},s=>{var n=Xe();ye(n,A=>R=A,()=>R);var l=Ie(n);K(l,()=>e.header,A=>{var S=_(),m=E(S);B(m,()=>e.header),g(A,S)});var T=ue(l,2);K(T,o,A=>{var S=_(),m=E(S);ze(m,17,t,Te,(z,L,se)=>{var Z=_(),oe=E(Z);B(oe,()=>e.vl_slot,()=>({item:i(L).item,index:se})),g(z,Z)}),g(A,S)},A=>{var S=_(),m=E(S);ze(m,17,()=>i(me),Te,(z,L,se)=>{var Z=_(),oe=E(Z);B(oe,()=>e.vl_slot,()=>({item:i(L).item,index:se})),g(z,Z)}),g(A,S)});var x=ue(T,2);K(x,()=>e.footer,A=>{var S=_(),m=E(S);B(m,()=>e.footer),g(A,S)}),he(n),Ae(()=>Ee(n,"style",i(ge))),g(s,n)}),he(p),Ae(()=>{je(p,i(Le)),Ee(p,"style",i(be))}),we(p,"clientHeight",s=>O(q,s)),we(p,"clientWidth",s=>O(le,s)),g(r,p),Ue()}export{re as A,F as D,Pe as S,tt as V,et as a};
