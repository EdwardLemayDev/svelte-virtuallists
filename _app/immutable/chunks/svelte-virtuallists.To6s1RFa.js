var Ke=Object.defineProperty;var Je=(l,e,s)=>e in l?Ke(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var $=(l,e,s)=>Je(l,typeof e!="symbol"?e+"":e,s);import{p as Fe,a as A,s as Z,b as F,u as ie,o as Ve,c as Le,g as t,d as y,e as be,i as X,f as ge,t as Ae,h as x,j as ke,k as Ee,l as de,m as ve,n as Se,r as fe,q as Ye,v as Ce,w as Xe,x as O,y as E,z as H,A as Ge,B as Ue,C as W,D as pe,E as Pe}from"./external.DlXsjIqe.js";class $e{constructor(e,s,r,g){$(this,"model");$(this,"modelCount");$(this,"itemSize");$(this,"estimatedItemSize");$(this,"itemSizeAndPositionData");$(this,"lastMeasuredIndex");$(this,"totalSize");this.model=e,this.itemSize=r,this.modelCount=s,this.estimatedItemSize=g,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,s,r){s!==void 0&&(this.modelCount=s),r!==void 0&&(this.estimatedItemSize=r),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:s}=this;return typeof s=="function"?s(this.model[e],e):Array.isArray(s)?s[e]:s}computeTotalSizeAndPositionData(){let e=0;for(let s=0;s<this.modelCount;s++){const r=this.getSize(s);this.itemSizeAndPositionData[s]={offset:e,size:r},e+=r}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.modelCount)throw Error(`Requested index ${e} is outside of range 0..${this.modelCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const s=this.getSizeAndPositionOfLastMeasuredItem();let r=s.offset+s.size;for(let g=this.lastMeasuredIndex+1;g<=e;g++){const a=this.getSize(g);if(a===void 0||isNaN(a))throw Error(`Invalid size returned for index ${g} of value ${a}`);this.itemSizeAndPositionData[g]={offset:r,size:a},r+=a}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=ce.START,s,r,g){if(s<=0)return 0;const a=this.getSizeAndPositionForIndex(g),v=a.offset,K=v-s+a.size;let T;switch(e){case ce.END:T=K;break;case ce.CENTER:T=v-(s-a.size)/2;break;case ce.START:T=v;break;default:T=Math.max(K,Math.min(v,r))}const he=this.getTotalSize();return Math.max(0,Math.min(he-s,T))}getVisibleRange(e=0,s,r){if(this.getTotalSize()===0)return{start:0,end:0};const a=s+e;let v=this.findNearestItem(s);if(v===void 0)throw Error(`Invalid offset ${s} specified`);const K=this.getSizeAndPositionForIndex(v);s=K.offset+K.size;let T=v;for(;s<a&&T<this.modelCount-1;)T++,s+=this.getSizeAndPositionForIndex(T).size;return r&&(v=Math.max(0,v-r),T=Math.min(T+r,this.modelCount-1)),{start:v,end:T}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const s=this.getSizeAndPositionOfLastMeasuredItem(),r=Math.max(0,this.lastMeasuredIndex);return s.offset>=e?this.binarySearch(0,r,e):this.exponentialSearch(r,e)}binarySearch(e,s,r){let g=0,a=0;for(;e<=s;){if(g=e+Math.floor((s-e)/2),a=this.getSizeAndPositionForIndex(g).offset,a===r)return g;a<r?e=g+1:a>r&&(s=g-1)}return e>0?e-1:0}exponentialSearch(e,s){let r=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<s;)e+=r,r*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),s)}}const et=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var tt=Ee('<div><!> <div class="virtual-list-inner svelte-f32i87"></div> <!></div>');function at(l,e){Fe(e,!0);const s=A(e,"width",3,"100%"),r=A(e,"model",19,()=>[]),g=A(e,"windowOverPadding",3,3),a=A(e,"scrollDirection",19,()=>U.VERTICAL),v=A(e,"scrollToAlignment",19,()=>ce.AUTO),K=A(e,"scrollToBehaviour",19,()=>Ne.INSTANT),T=A(e,"class",3,"");A(e,"style",3,"");const he=Xe(e,["$$slots","$$events","$$legacy","height","width","model","modelCount","itemSize","estimatedItemSize","getKey","scrollToIndex","scrollOffset","windowOverPadding","scrollDirection","scrollToAlignment","scrollToBehaviour","footer","slot","header","onVisibleRangeUpdate","onAfterScroll","class","style"]),ye={[U.VERTICAL]:"top",[U.HORIZONTAL]:"left"},Te={[U.VERTICAL]:"scrollTop",[U.HORIZONTAL]:"scrollLeft"},V=new $e(r(),e.modelCount,e.itemSize,e.estimatedItemSize);let R=!1,b,G=Z(F([])),M=Z(F({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&se(e.scrollToIndex)||0,scrollChangeReason:re.REQUESTED})),j={},k={scrollToIndex:e.scrollToIndex,scrollToAlignment:v(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},N={},D=Z(""),_=Z("");ie(()=>{e.scrollToIndex,v(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,ne()}),ie(()=>{const{offset:d,scrollChangeReason:h}=t(M);(j.offset!==d||j.scrollChangeReason!==h)&&ee(),j.offset!==d&&h===re.REQUESTED&&w(d),j=t(M)}),ie(()=>{e.height,s(),R&&C(0)}),(()=>{if(a()===U.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(a()===U.HORIZONTAL&&typeof s()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");ee()})(),Ve(()=>{b.addEventListener("scroll",oe,et),e.scrollOffset!==void 0?w(e.scrollOffset):e.scrollToIndex!==void 0&&w(se(e.scrollToIndex)),R=!0}),Le(()=>{R&&b.removeEventListener("scroll",oe)});function ne(){if(!R)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset MUST NOT be used together.");const d=k.scrollToIndex!==e.scrollToIndex||k.scrollToAlignment!==v(),h=k.modelCount!==e.modelCount||k.itemSize!==e.itemSize||k.estimatedItemSize!==e.estimatedItemSize;h&&(V.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),C()),k.scrollOffset!==e.scrollOffset?y(M,F({offset:e.scrollOffset||0,scrollChangeReason:re.REQUESTED})):typeof e.scrollToIndex=="number"&&(d||h)&&y(M,F({offset:se(e.scrollToIndex,v(),e.modelCount),scrollChangeReason:re.REQUESTED})),k={scrollToIndex:e.scrollToIndex,scrollToAlignment:v(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function ee(){const{offset:d}=t(M);let{start:h,end:z}=V.getVisibleRange(a()===U.VERTICAL?e.height:s(),d,g()),q=[];const Q=V.getTotalSize(),Ie=typeof e.height=="number"?"px":"",xe=typeof s()=="number"?"px":"";if(a()===U.VERTICAL?(y(D,`height:${e.height}${Ie};width:${s()}${xe};`),y(_,`flex-direction:column;height:${Q}px;`)):(y(D,`height:${e.height}${Ie};width:${s()}${xe};`),y(_,`min-height:100%;width:${Q}px;`)),h!==void 0&&z!==void 0){for(let B=h;B<=z;(B+=1)-1)q.push({item:r()[B],index:B,style:le(B)});if(e.onVisibleRangeUpdate){const B=V.getVisibleRange(a()===U.VERTICAL?e.height:s(),d,0);e.onVisibleRangeUpdate({type:"range.update",start:B.start,end:B.end})}}y(G,F(q))}function w(d){"scroll"in b?b.scroll({[ye[a()]]:d,behavior:K()}):b[Te[a()]]=d}function C(d=0){N={},V.resetItem(d),ee()}function se(d,h=v(),z=e.modelCount){return d<0?d=0:d>=z&&(d=z-1),V.getUpdatedOffsetForIndex(h,a()===U.VERTICAL?e.height:s(),t(M).offset||0,d)}const oe=d=>{const h=b[Te[a()]];h<0||t(M).offset===h||d.target!==b||(y(M,F({offset:h,scrollChangeReason:re.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:h,event:d}))};function le(d){if(N[d])return N[d];const{size:h,offset:z}=V.getSizeAndPositionForIndex(d);let q;return a()===U.VERTICAL?q=`left:0;width:100%;height:${h}px;position:absolute;top:${z}px;`:q=`top:0;width:${h}px;position:absolute;height:100%;left:${z}px;`,N[d]=q}var J=tt();be(J,d=>b=d,()=>b);let ze;var ue=ve(J);X(ue,()=>e.header,d=>{var h=O(),z=E(h);H(z,()=>e.header),x(d,h)});var L=de(ue,2);ge(L,21,()=>t(G),Se,(d,h)=>{var z=O(),q=E(z),Q=Ge(()=>({item:t(h).item,style:t(h).style,index:e.getKey?e.getKey(t(h).index):t(h).index}));H(q,()=>e.slot,()=>t(Q)),x(d,z)}),fe(L);var Oe=de(L,2);return X(Oe,()=>e.footer,d=>{var h=O(),z=E(h);H(z,()=>e.footer),x(d,h)}),fe(J),Ae(()=>{ze=Ye(J,ze,{class:`virtual-list-wrapper $${T()??""}`,style:t(D),...he},"svelte-f32i87"),Ce(L,"style",t(_))}),x(l,J),ke({recomputeSizes:C})}var Ne=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Ne||{}),ce=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(ce||{}),U=(l=>(l.HORIZONTAL="horizontal",l.VERTICAL="vertical",l))(U||{}),re=(l=>(l[l.OBSERVED=0]="OBSERVED",l[l.REQUESTED=1]="REQUESTED",l))(re||{}),Qe=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Qe||{}),ae=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(ae||{});const it=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var nt=Ee('<table class="vtlist-inner"><!><tbody><!></tbody></table> <!>',1),st=Ee('<div class="vtlist-inner"><!> <!> <!></div>'),ot=Ee("<div><!></div>");function dt(l,e){Fe(e,!0);var s;(function(i){i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED"})(s||(s={}));const r=A(e,"items",19,()=>[]),g=A(e,"isDisabled",3,!1),a=A(e,"isHorizontal",3,!1),v=A(e,"isTable",3,!1),K=A(e,"preRenderCount",3,6),T=A(e,"scrollToAlignment",19,()=>ae.AUTO),he=A(e,"scrollToBehaviour",19,()=>Qe.INSTANT),ye=A(e,"class",3,""),Te=A(e,"style",3,"");let V=!1,R,b,G=Z(0),M=Z(0),j=Z(0),k=Z(K()-1),N=Z(0),D=Z(F({offset:e.scrollToOffset||e.scrollToIndex!==void 0&&r().length&&z(e.scrollToIndex)&&1||0,scrollChangeReason:s.REQUESTED})),_;const ne=W(()=>{var n;const i=(((n=r())==null?void 0:n.length)||1)-1;return t(k)<i?t(k):i}),ee=W(()=>new Array(r().length)),w=W(()=>r().map((i,n)=>{var u;let o=(u=e.sizingCalculator)==null?void 0:u.call(e,n,i);return o!==void 0||(o=t(ee)[n],o!==void 0)?o:t(N)})),C=W(()=>{const i=[];return t(w).reduce((n,o)=>(i.push(n),n+o),0),i}),se=W(()=>{if(!r()||g())return[];const i=[];for(let n=t(j);n<=t(ne);(n+=1)-1){const o=r()[n];o&&i.push({item:o,index:n,size:t(w)[n]})}return i}),oe=W(()=>t(C)[t(j)]?t(C)[t(j)]:0),le=W(()=>t(C).length>0?t(C)[t(C).length-1]+t(w)[t(w).length-1]:0),J=W(()=>t(C)[t(ne)]?t(le)-t(C)[t(ne)]-t(w)[t(ne)]:0),ze=W(()=>Pe(!g()&&"overflow:auto;",Te())),ue=W(()=>Pe(!v()&&"display:flex;",!v()&&(!a()&&"flex-direction:column;"||"flex-direction:row;"),!g()&&(!a()&&`margin-top:${t(oe)}px;margin-bottom:${t(J)}px`||`margin-left:${t(oe)}px;margin-right:${t(J)}px;width:${t(le)-t(J)-t(oe)}px`)));Ve(()=>{R.addEventListener("scroll",h,it),Re(),e.scrollToOffset!==void 0?Me(e.scrollToOffset):e.scrollToIndex!==void 0&&Me(z(e.scrollToIndex)),V=!0}),Le(()=>{V&&R.removeEventListener("scroll",h)}),ie(()=>{e.scrollToIndex,T(),e.scrollToOffset,r().length,e.sizingCalculator,console.log("propUpdated"),Oe()}),ie(()=>{if(console.log("onVisibleRangeUpdate"),e.onVisibleRangeUpdate){const i=De(a()?t(M):t(G),t(D).offset);e.onVisibleRangeUpdate(i)}}),ie(()=>{const{offset:i,scrollChangeReason:n}=t(D);((_==null?void 0:_.offset)!==i||(_==null?void 0:_.scrollChangeReason)!==n)&&Re(),(_==null?void 0:_.offset)!==i&&n===s.REQUESTED&&Me(i),_=t(D)}),ie(()=>{console.log("component is resized "+t(G)+" "+t(M)),V&&d(0)});let L={scrollToIndex:e.scrollToIndex,scrollToAlignment:T(),scrollToOffset:e.scrollToOffset,modelCount:r().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:t(N)};function Oe(){if(!V)return;e.scrollToIndex&&e.scrollToOffset&&console.log("VirtualList: scrollToIndex and scrollToOffset MUST NOT be used together.");const i=L.scrollToIndex!==e.scrollToIndex||L.scrollToAlignment!==T(),n=L.modelCount!==r().length||L.sizingCalculator!==e.sizingCalculator||L.avgSizeInPx!==t(N);n&&d(),L.scrollToOffset!==e.scrollToOffset?y(D,F({offset:e.scrollToOffset||0,scrollChangeReason:s.REQUESTED})):typeof e.scrollToIndex=="number"&&(i||n)&&y(D,F({offset:z(e.scrollToIndex),scrollChangeReason:s.REQUESTED})),L={scrollToIndex:e.scrollToIndex,scrollToAlignment:T(),scrollToOffset:e.scrollToOffset,modelCount:r().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:t(N)}}function d(i=0){Q=Math.min(Q,i-1),Re()}function h(i){var o;const n=je(R);i.target!==R||n<0||t(D).offset===n||(y(D,F({offset:n,scrollChangeReason:s.OBSERVED})),(o=e.onAfterScroll)==null||o.call(e,{offset:n,event:i}))}function z(i,n=T(),o=r().length){return i<0?i=0:i>=o&&(i=o-1),q(n,a()?t(M):t(G),t(D).offset||0,i)}function q(i=ae.START,n,o,u){if(n<=0)return 0;const m=t(w)[u],f=t(C)[u],S=f-n+m;let c;switch(i){case ae.END:c=S;break;case ae.CENTER:c=f-(n-m)/2;break;case ae.START:c=f;break;default:c=Math.max(S,Math.min(f,o))}const I=t(le);return Math.max(0,Math.min(I-n,c))}let Q=-1;function Ie(i){if(isNaN(i))throw Error(`Invalid offset ${i} specified`);i=Math.max(0,i);const n=xe(),o=Math.max(0,Q);return n.offset>=i?B(0,o,i):Be(o,i)}function xe(){return Q>=0?{offset:t(C)[Q],size:t(w)[Q]}:{offset:0,size:0}}function B(i,n,o){let u=0,m=0;for(;i<=n;){if(u=i+Math.floor((n-i)/2),m=t(C)[u],m===o)return u;m<o?i=u+1:m>o&&(n=u-1)}return i>0?i-1:0}function Be(i,n){let o=1;for(;i<r().length&&t(C)[i]<n;)i+=o,o*=2;return B(Math.floor(i/2),Math.min(i,r().length-1),n)}function Re(){t(N)||y(N,F(We()));const i=De(a()?t(M):t(G),t(D).offset,3);y(j,F(i.start)),y(k,F(i.end));let n=0;const o={},u=v()?b.querySelector("tbody").children:b.children;for(let m=0;m<u.length;(m+=1)-1){const f=u[m],S=getComputedStyle(f),c=S.position;if(c&&["absolute","fixed"].includes(c))continue;const I=S.display!=="none"?we(f):0,P=t(j)+n;o[P]=(o[P]||0)+I,n+=1}for(const m of Object.keys(o)){const f=parseInt(m);t(ee)[f]!==o[f]&&(t(ee)[f]=o[f])}}function We(){const n=[],o=v()?b.querySelector("tbody").children:b.children;for(let u=0;u<o.length;(u+=1)-1){const m=o[u],f=getComputedStyle(m);if(["absolute","fixed"].includes(f.position))continue;const S=we(m);if(n.push(S),n.length>=10)break}return n.length===0?0:n.reduce((u,m)=>u+m,0)/n.length}function He(i){const n=getComputedStyle(i);let o=parseFloat(a()?n.width:n.height);return n.boxSizing==="border-box"&&(a()?o-=parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth):o-=parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth)),o}function De(i=0,n,o=0){if(t(le)===0)return{start:0,end:0};const m=n+i;let f=Ie(n);if(f===void 0)throw Error(`Invalid offset ${n} specified`);let S=t(C)[f]+t(w)[f],c=f;for(;S<m&&c<r().length-1;)c+=1,S+=t(w)[c];return o>0&&(f=Math.max(0,f-o),c=Math.min(c+o,r().length-1)),{start:f,end:c}}function we(i){const n=getComputedStyle(i);let o=He(i);return a()?o+=parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth)+parseFloat(n.marginLeft)+parseFloat(n.marginRight):o+=parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth)+parseFloat(n.marginTop)+parseFloat(n.marginBottom),Number.isNaN(o)?0:o}function je(i){return a()?i.scrollLeft:i.scrollTop}function Me(i){if("scroll"in R){const n={behavior:he()};n[a()?"left":"top"]=i,R.scroll(n)}else R[a()?"scrollLeft":"scrollTop"]=i}var p=ot();be(p,i=>R=i,()=>R);const qe=W(()=>Pe("vtlist",ye()));var Ze=ve(p);X(Ze,v,i=>{var n=nt(),o=E(n);be(o,c=>b=c,()=>b);var u=ve(o);X(u,()=>e.header,c=>{var I=O(),P=E(I);H(P,()=>e.header),x(c,I)});var m=de(u),f=ve(m);X(f,g,c=>{var I=O(),P=E(I);ge(P,17,r,Se,(Y,te)=>{var me=O(),_e=E(me);H(_e,()=>e.vl_slot,()=>t(te)),x(Y,me)}),x(c,I)},c=>{var I=O(),P=E(I);ge(P,17,()=>t(se),Se,(Y,te)=>{var me=O(),_e=E(me);H(_e,()=>e.vl_slot,()=>t(te)),x(Y,me)}),x(c,I)}),fe(m),fe(o);var S=de(o,2);X(S,()=>e.footer,c=>{var I=O(),P=E(I);H(P,()=>e.footer),x(c,I)}),Ae(()=>Ce(o,"style",t(ue))),x(i,n)},i=>{var n=st();be(n,f=>b=f,()=>b);var o=ve(n);X(o,()=>e.header,f=>{var S=O(),c=E(S);H(c,()=>e.header),x(f,S)});var u=de(o,2);X(u,g,f=>{var S=O(),c=E(S);ge(c,17,r,Se,(I,P)=>{var Y=O(),te=E(Y);H(te,()=>e.vl_slot,()=>t(P)),x(I,Y)}),x(f,S)},f=>{var S=O(),c=E(S);ge(c,17,()=>t(se),Se,(I,P)=>{var Y=O(),te=E(Y);H(te,()=>e.vl_slot,()=>t(P)),x(I,Y)}),x(f,S)});var m=de(u,2);X(m,()=>e.footer,f=>{var S=O(),c=E(S);H(c,()=>e.footer),x(f,S)}),fe(n),Ae(()=>Ce(n,"style",t(ue))),x(i,n)}),fe(p),Ae(()=>{pe(p,t(qe)),Ce(p,"style",t(ze))}),Ue(p,"clientHeight",i=>y(G,i)),Ue(p,"clientWidth",i=>y(M,i)),x(l,p),ke()}export{ce as A,U as D,Ne as S,dt as V,at as a};
