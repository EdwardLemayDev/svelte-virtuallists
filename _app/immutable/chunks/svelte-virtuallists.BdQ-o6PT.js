var tt=Object.defineProperty;var it=(l,e,t)=>e in l?tt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var q=(l,e,t)=>it(l,typeof e!="symbol"?e+"":e,t);import{p as Ve,a as x,s as J,b as w,u as ae,o as Ne,c as Qe,g as i,d as O,e as ye,i as ne,f as ve,t as be,h as A,j as ke,k as Me,l as ce,m as Ie,n as xe,r as he,q as nt,v as Oe,w as st,x as _,y as D,z as K,A as qe,B as De,C as Y,D as Ke,E as Pe}from"./external.Jk2Vr2rG.js";let ot=class{constructor(e,t,o,d){q(this,"model");q(this,"modelCount");q(this,"itemSize");q(this,"estimatedItemSize");q(this,"itemSizeAndPositionData");q(this,"lastMeasuredIndex");q(this,"totalSize");this.model=e,this.itemSize=o,this.modelCount=t,this.estimatedItemSize=d,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,o){t!==void 0&&(this.modelCount=t),o!==void 0&&(this.estimatedItemSize=o),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(this.model[e],e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const o=this.getSize(t);this.itemSizeAndPositionData[t]={offset:e,size:o},e+=o}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.modelCount)throw Error(`Requested index ${e} is outside of range 0..${this.modelCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let o=t.offset+t.size;for(let d=this.lastMeasuredIndex+1;d<=e;d++){const a=this.getSize(d);if(a===void 0||isNaN(a))throw Error(`Invalid size returned for index ${d} of value ${a}`);this.itemSizeAndPositionData[d]={offset:o,size:a},o+=a}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=Ae.START,t,o,d){if(t<=0)return 0;const a=this.getSizeAndPositionForIndex(d),h=a.offset,P=h-t+a.size;let u;switch(e){case Ae.END:u=P;break;case Ae.CENTER:u=h-(t-a.size)/2;break;case Ae.START:u=h;break;default:u=Math.max(P,Math.min(h,o))}const N=this.getTotalSize();return Math.max(0,Math.min(N-t,u))}getVisibleRange(e=0,t,o){if(this.getTotalSize()===0)return{start:0,end:0};const a=t+e;let h=this.findNearestItem(t);if(h===void 0)throw Error(`Invalid offset ${t} specified`);const P=this.getSizeAndPositionForIndex(h);t=P.offset+P.size;let u=h;for(;t<a&&u<this.modelCount-1;)u++,t+=this.getSizeAndPositionForIndex(u).size;return o&&(h=Math.max(0,h-o),u=Math.min(u+o,this.modelCount-1)),{start:h,end:u}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),o=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,o,e):this.exponentialSearch(o,e)}binarySearch(e,t,o){let d=0,a=0;for(;e<=t;){if(d=e+Math.floor((t-e)/2),a=this.getSizeAndPositionForIndex(d).offset,a===o)return d;a<o?e=d+1:a>o&&(t=d-1)}return e>0?e-1:0}exponentialSearch(e,t){let o=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=o,o*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}};const lt=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var at=Me('<div><!> <div class="virtual-list-inner svelte-f32i87"></div> <!></div>');function Tt(l,e){Ve(e,!0);const t=x(e,"width",3,"100%"),o=x(e,"model",19,()=>[]),d=x(e,"windowOverPadding",3,3),a=x(e,"scrollDirection",19,()=>Z.VERTICAL),h=x(e,"scrollToAlignment",19,()=>Ae.AUTO),P=x(e,"scrollToBehaviour",19,()=>Je.INSTANT),u=x(e,"class",3,"");x(e,"style",3,"");const N=st(e,["$$slots","$$events","$$legacy","height","width","model","modelCount","itemSize","estimatedItemSize","getKey","scrollToIndex","scrollOffset","windowOverPadding","scrollDirection","scrollToAlignment","scrollToBehaviour","footer","slot","header","onVisibleRangeUpdate","onAfterScroll","class","style"]),se={[Z.VERTICAL]:"top",[Z.HORIZONTAL]:"left"},p={[Z.VERTICAL]:"scrollTop",[Z.HORIZONTAL]:"scrollLeft"},U=new ot(o(),e.modelCount,e.itemSize,e.estimatedItemSize);let S=!1,C,Q=J(w([])),V=J(w({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&I(e.scrollToIndex)||0,scrollChangeReason:Se.REQUESTED})),H={},k={scrollToIndex:e.scrollToIndex,scrollToAlignment:h(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},$={},X=J(""),L=J("");ae(()=>{e.scrollToIndex,h(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,B()}),ae(()=>{const{offset:f,scrollChangeReason:g}=i(V);(H.offset!==f||H.scrollChangeReason!==g)&&G(),H.offset!==f&&g===Se.REQUESTED&&ee(f),H=i(V)}),ae(()=>{e.height,t(),S&&W(0)}),(()=>{if(a()===Z.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(a()===Z.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");G()})(),Ne(()=>{C.addEventListener("scroll",de,lt),e.scrollOffset!==void 0?ee(e.scrollOffset):e.scrollToIndex!==void 0&&ee(I(e.scrollToIndex)),S=!0}),Qe(()=>{S&&C.removeEventListener("scroll",de)});function B(){if(!S)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset MUST NOT be used together.");const f=k.scrollToIndex!==e.scrollToIndex||k.scrollToAlignment!==h(),g=k.modelCount!==e.modelCount||k.itemSize!==e.itemSize||k.estimatedItemSize!==e.estimatedItemSize;g&&(U.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),W()),k.scrollOffset!==e.scrollOffset?O(V,w({offset:e.scrollOffset||0,scrollChangeReason:Se.REQUESTED})):typeof e.scrollToIndex=="number"&&(f||g)&&O(V,w({offset:I(e.scrollToIndex,h(),e.modelCount),scrollChangeReason:Se.REQUESTED})),k={scrollToIndex:e.scrollToIndex,scrollToAlignment:h(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function G(){const{offset:f}=i(V);let{start:g,end:R}=U.getVisibleRange(a()===Z.VERTICAL?e.height:t(),f,d()),le=[];const me=U.getTotalSize(),ge=typeof e.height=="number"?"px":"",Re=typeof t()=="number"?"px":"";if(a()===Z.VERTICAL?(O(X,`height:${e.height}${ge};width:${t()}${Re};`),O(L,`flex-direction:column;height:${me}px;`)):(O(X,`height:${e.height}${ge};width:${t()}${Re};`),O(L,`min-height:100%;width:${me}px;`)),g!==void 0&&R!==void 0){for(let j=g;j<=R;(j+=1)-1)le.push({item:o()[j],index:j,style:oe(j)});if(e.onVisibleRangeUpdate){const j=U.getVisibleRange(a()===Z.VERTICAL?e.height:t(),f,0);e.onVisibleRangeUpdate({type:"range.update",start:j.start,end:j.end})}}O(Q,w(le))}function ee(f){"scroll"in C?C.scroll({[se[a()]]:f,behavior:P()}):C[p[a()]]=f}function W(f=0){$={},U.resetItem(f),G()}function I(f,g=h(),R=e.modelCount){return f<0?f=0:f>=R&&(f=R-1),U.getUpdatedOffsetForIndex(g,a()===Z.VERTICAL?e.height:t(),i(V).offset||0,f)}const de=f=>{const g=C[p[a()]];g<0||i(V).offset===g||f.target!==C||(O(V,w({offset:g,scrollChangeReason:Se.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:g,event:f}))};function oe(f){if($[f])return $[f];const{size:g,offset:R}=U.getSizeAndPositionForIndex(f);let le;return a()===Z.VERTICAL?le=`left:0;width:100%;height:${g}px;position:absolute;top:${R}px;`:le=`top:0;width:${g}px;position:absolute;height:100%;left:${R}px;`,$[f]=le}var te=at();ye(te,f=>C=f,()=>C);let c;var m=Ie(te);ne(m,()=>e.header,f=>{var g=_(),R=D(g);K(R,()=>e.header),A(f,g)});var E=ce(m,2);ve(E,21,()=>i(Q),xe,(f,g)=>{var R=_(),le=D(R),me=qe(()=>({item:i(g).item,style:i(g).style,index:e.getKey?e.getKey(i(g).index):i(g).index}));K(le,()=>e.slot,()=>i(me)),A(f,R)}),he(E);var F=ce(E,2);return ne(F,()=>e.footer,f=>{var g=_(),R=D(g);K(R,()=>e.footer),A(f,g)}),he(te),be(()=>{c=nt(te,c,{class:`virtual-list-wrapper $${u()??""}`,style:i(X),...N},"svelte-f32i87"),Oe(E,"style",i(L))}),A(l,te),ke({recomputeSizes:W})}var Je=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Je||{}),Ae=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(Ae||{}),Z=(l=>(l.HORIZONTAL="horizontal",l.VERTICAL="vertical",l))(Z||{}),Se=(l=>(l[l.OBSERVED=0]="OBSERVED",l[l.REQUESTED=1]="REQUESTED",l))(Se||{}),Ze=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Ze||{}),ze=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(ze||{});const rt=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var dt=Me('<table class="vtlist-inner"><!><tbody><!></tbody></table> <!>',1),ft=Me('<div class="vtlist-inner"><!> <!> <!></div>'),ct=Me("<div><!></div>");function vt(l,e){Ve(e,!0);var t;(function(n){n[n.OBSERVED=0]="OBSERVED",n[n.REQUESTED=1]="REQUESTED"})(t||(t={}));const o=x(e,"items",19,()=>[]),d=x(e,"isDisabled",3,!1),a=x(e,"isHorizontal",3,!1),h=x(e,"isTable",3,!1),P=x(e,"preRenderCount",3,6),u=x(e,"scrollToAlignment",19,()=>ze.AUTO),N=x(e,"scrollToBehaviour",19,()=>Ze.INSTANT),se=x(e,"class",3,""),p=x(e,"style",3,"");let U=!1,S,C,Q=J(0),V=J(0),H=100,k=J(0),$=J(P()-1),X=J(0),L=J(w({offset:e.scrollToOffset||e.scrollToIndex!==void 0&&o().length&&ge(e.scrollToIndex)&&1||0,scrollChangeReason:t.REQUESTED})),B;const G=Y(()=>{var s;const n=(((s=o())==null?void 0:s.length)||1)-1;return i($)<n?i($):n}),ee=Y(()=>new Array(o().length)),W=Y(()=>o().map((n,s)=>{var z;let r=(z=e.sizingCalculator)==null?void 0:z.call(e,s,n);return r!==void 0||(r=i(ee)[s],r!==void 0)?r:i(X)})),I=Y(()=>{const n=[];return i(W).reduce((s,r)=>(n.push(s),s+r),0),n}),de=Y(()=>{if(!o()||d())return[];const n=[];for(let s=i(k);s<=i(G);(s+=1)-1){const r=o()[s];r&&n.push({item:r,index:s,size:i(W)[s]})}return n}),oe=Y(()=>i(I)[i(k)]?i(I)[i(k)]:0),te=Y(()=>i(I).length>0?i(I)[i(I).length-1]+i(W)[i(W).length-1]:0),c=Y(()=>i(I)[i(G)]?i(te)-i(I)[i(G)]-i(W)[i(G)]:0),m=Y(()=>Pe(!d()&&"overflow:auto;",p())),E=Y(()=>Pe(!h()&&"display:flex;",!h()&&(!a()&&"flex-direction:column;"||"flex-direction:row;"),!d()&&(!a()&&`margin-top:${i(oe)}px;margin-bottom:${i(c)}px`||`margin-left:${i(oe)}px;margin-right:${i(c)}px;width:${i(te)-i(c)-i(oe)}px`)));Ne(()=>{S.addEventListener("scroll",R,rt),we(),e.scrollToOffset!==void 0?_e(e.scrollToOffset):e.scrollToIndex!==void 0&&_e(ge(e.scrollToIndex)),U=!0}),Qe(()=>{U&&S.removeEventListener("scroll",R)}),ae(()=>{e.scrollToIndex,u(),e.scrollToOffset,o().length,e.sizingCalculator,console.log("propUpdated"),f()}),ae(()=>{var n;console.log("onVisibleRangeUpdate"),(n=e.onVisibleRangeUpdate)==null||n.call(e,{start:i(k),end:i($)})}),ae(()=>{const{offset:n,scrollChangeReason:s}=i(L);((B==null?void 0:B.offset)!==n||(B==null?void 0:B.scrollChangeReason)!==s)&&we(),(B==null?void 0:B.offset)!==n&&s===t.REQUESTED&&_e(n),B=i(L)}),ae(()=>{console.log("component is resized "+i(Q)+" "+i(V)),U&&g(0)});let F={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollToOffset:e.scrollToOffset,modelCount:o().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:i(X)};function f(){if(!U)return;e.scrollToIndex&&e.scrollToOffset&&console.log("VirtualList: scrollToIndex and scrollToOffset MUST NOT be used together.");const n=F.scrollToIndex!==e.scrollToIndex||F.scrollToAlignment!==u(),s=F.modelCount!==o().length||F.sizingCalculator!==e.sizingCalculator||F.avgSizeInPx!==i(X);s&&g(),F.scrollToOffset!==e.scrollToOffset?O(L,w({offset:e.scrollToOffset||0,scrollChangeReason:t.REQUESTED})):typeof e.scrollToIndex=="number"&&(n||s)&&O(L,w({offset:ge(e.scrollToIndex),scrollChangeReason:t.REQUESTED})),F={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollToOffset:e.scrollToOffset,modelCount:o().length,sizingCalculator:e.sizingCalculator,avgSizeInPx:i(X)}}function g(n=0){j=Math.min(j,n-1),we()}function R(n){var r;const s=Fe(S);n.target!==S||s<0||i(L).offset===s||(O(L,w({offset:s,scrollChangeReason:t.OBSERVED})),(r=e.onAfterScroll)==null||r.call(e,{offset:s,event:n}))}function le(){const n=Fe(S)-We(S)-H;return Be(n)}function me(){const n=Fe(S)-We(S)+je(S)+H;return Be(n)}function ge(n,s=u(),r=o().length){return n<0?n=0:n>=r&&(n=r-1),Re(s,a()?i(V):i(Q),i(L).offset||0,n)}function Re(n=ze.START,s,r,z){if(s<=0)return 0;const T=i(W)[z],y=i(I)[z],b=y-s+T;let v;switch(n){case ze.END:v=b;break;case ze.CENTER:v=y-(s-T)/2;break;case ze.START:v=y;break;default:v=Math.max(b,Math.min(y,r))}const M=i(te);return Math.max(0,Math.min(M-s,v))}let j=-1;function Be(n){if(isNaN(n))throw Error(`Invalid offset ${n} specified`);n=Math.max(0,n);const s=Xe(),r=Math.max(0,j);return s.offset>=n?Le(0,r,n):Ge(r,n)}function Xe(){return j>=0?{offset:i(I)[j],size:i(W)[j]}:{offset:0,size:0}}function Le(n,s,r){let z=0,T=0;for(;n<=s;){if(z=n+Math.floor((s-n)/2),T=i(I)[z],T===r)return z;T<r?n=z+1:T>r&&(s=z-1)}return n>0?n-1:0}function Ge(n,s){let r=1;for(;n<o().length&&i(I)[n]<s;)n+=r,r*=2;return Le(Math.floor(n/2),Math.min(n,o().length-1),s)}function we(){i(X)||O(X,w(pe())),O(k,w(le())),O($,w(me()));let n=0;const s={},r=h()?C.querySelector("tbody").children:C.children;for(let z=0;z<r.length;(z+=1)-1){const T=r[z],y=getComputedStyle(T),b=y.position;if(b&&["absolute","fixed"].includes(b))continue;const v=y.display!=="none"?He(T):0,M=i(k)+n;s[M]=(s[M]||0)+v,n+=1}for(const z of Object.keys(s)){const T=parseInt(z);i(ee)[T]!==s[T]&&(i(ee)[T]=s[T])}}function pe(){const s=[],r=h()?C.querySelector("tbody").children:C.children;for(let z=0;z<r.length;(z+=1)-1){const T=r[z],y=getComputedStyle(T);if(["absolute","fixed"].includes(y.position))continue;const b=He(T);if(s.push(b),s.length>=10)break}return s.length===0?0:s.reduce((z,T)=>z+T,0)/s.length}function je(n){const s=getComputedStyle(n);let r=parseFloat(a()?s.width:s.height);return s.boxSizing==="border-box"&&(a()?r-=parseFloat(s.borderLeftWidth)-parseFloat(s.borderRightWidth):r-=parseFloat(s.borderTopWidth)-parseFloat(s.borderBottomWidth)),r}function He(n){const s=getComputedStyle(n);let r=je(n);return a()?r+=parseFloat(s.borderLeftWidth)+parseFloat(s.borderRightWidth)+parseFloat(s.marginLeft)+parseFloat(s.marginRight):r+=parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)+parseFloat(s.marginTop)+parseFloat(s.marginBottom),Number.isNaN(r)?0:r}function Fe(n){return a()?n.scrollLeft:n.scrollTop}function We(n){const s=getComputedStyle(n);return a()?parseFloat(s.paddingLeft):parseFloat(s.paddingTop)}function _e(n){if("scroll"in S){const s={behavior:N()};s[a()?"left":"top"]=n,S.scroll(s)}else S[a()?"scrollLeft":"scrollTop"]=n}var fe=ct();ye(fe,n=>S=n,()=>S);const $e=Y(()=>Pe("vtlist",se()));var et=Ie(fe);ne(et,h,n=>{var s=dt(),r=D(s);ye(r,v=>C=v,()=>C);var z=Ie(r);ne(z,()=>e.header,v=>{var M=_(),ie=D(M);K(ie,()=>e.header),A(v,M)});var T=ce(z),y=Ie(T);ne(y,d,v=>{var M=_(),ie=D(M);ve(ie,17,o,xe,(re,ue)=>{var Ce=_(),Ue=D(Ce);K(Ue,()=>e.vl_slot,()=>i(ue)),A(re,Ce)}),A(v,M)},v=>{var M=_(),ie=D(M);ve(ie,17,()=>i(de),xe,(re,ue)=>{var Ce=_(),Ue=D(Ce);K(Ue,()=>e.vl_slot,()=>i(ue)),A(re,Ce)}),A(v,M)}),he(T),he(r);var b=ce(r,2);ne(b,()=>e.footer,v=>{var M=_(),ie=D(M);K(ie,()=>e.footer),A(v,M)}),be(()=>Oe(r,"style",i(E))),A(n,s)},n=>{var s=ft();ye(s,y=>C=y,()=>C);var r=Ie(s);ne(r,()=>e.header,y=>{var b=_(),v=D(b);K(v,()=>e.header),A(y,b)});var z=ce(r,2);ne(z,d,y=>{var b=_(),v=D(b);ve(v,17,o,xe,(M,ie)=>{var re=_(),ue=D(re);K(ue,()=>e.vl_slot,()=>i(ie)),A(M,re)}),A(y,b)},y=>{var b=_(),v=D(b);ve(v,17,()=>i(de),xe,(M,ie)=>{var re=_(),ue=D(re);K(ue,()=>e.vl_slot,()=>i(ie)),A(M,re)}),A(y,b)});var T=ce(z,2);ne(T,()=>e.footer,y=>{var b=_(),v=D(b);K(v,()=>e.footer),A(y,b)}),he(s),be(()=>Oe(s,"style",i(E))),A(n,s)}),he(fe),be(()=>{Ke(fe,i($e)),Oe(fe,"style",i(m))}),De(fe,"clientHeight",n=>O(Q,n)),De(fe,"clientWidth",n=>O(V,n)),A(l,fe),ke()}class ht{constructor(e,t,o){q(this,"model");q(this,"sizeCalculatorFn");q(this,"averageSize");q(this,"itemSizeAndPositionData",{});q(this,"lastMeasuredIndex",-1);q(this,"totalSize");this.model=e,this.sizeCalculatorFn=t,this.averageSize=o,this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.sizeCalculatorFn=="function"}mutateState(e,t,o){t&&this.model.length!==t.length&&(this.model=t),o!==void 0&&(this.averageSize=o),e!==void 0&&(this.sizeCalculatorFn=e),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}getSize(e){var t;return((t=this.sizeCalculatorFn)==null?void 0:t.call(this,this.model[e],e))||this.averageSize}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.model.length;t++){let o=this.getSize(t);o||(o=0),this.itemSizeAndPositionData[t]={offset:e,size:o},e+=o}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.model.length)throw Error(`Requested index ${e} is outside of range 0..${this.model.length}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let o=t.offset+t.size;for(let d=this.lastMeasuredIndex+1;d<=e;d++){const a=this.getSize(d);if(a===void 0||isNaN(a))throw Error(`Invalid size returned for index ${d} of value ${a}`);this.itemSizeAndPositionData[d]={offset:o,size:a},o+=a}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.averageSize||typeof this.sizeCalculatorFn=="number"&&this.sizeCalculatorFn||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.model.length-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=Ee.START,t,o,d){if(t<=0)return 0;const a=this.getSizeAndPositionForIndex(d),h=a.offset,P=h-t+a.size;let u;switch(e){case Ee.END:u=P;break;case Ee.CENTER:u=h-(t-a.size)/2;break;case Ee.START:u=h;break;default:u=Math.max(P,Math.min(h,o))}const N=this.getTotalSize();return Math.max(0,Math.min(N-t,u))}getVisibleRangeOffsets(e=0,t){if(this.getTotalSize()===0)return{start:0,end:0};const d=t+e,a=t;let h=this.findNearestItem(t);if(h===void 0)throw Error(`Invalid offset ${t} specified`);const P=this.getSizeAndPositionForIndex(h);t=P.offset+P.size;let u=h;for(;t<d&&u<this.model.length-1;)u++,t+=this.getSizeAndPositionForIndex(u).size;return{startOffset:a,endOffset:t}}getVisibleRangeIndex(e=0,t,o){if(this.getTotalSize()===0)return{start:0,end:0};const a=t+e;let h=this.findNearestItem(t);if(h===void 0)throw Error(`Invalid offset ${t} specified`);const P=this.getSizeAndPositionForIndex(h);t=P.offset+P.size;let u=h;for(;t<a&&u<this.model.length-1;)u++,t+=this.getSizeAndPositionForIndex(u).size;return o&&(h=Math.max(0,h-o),u=Math.min(u+o,this.model.length-1)),{start:h,end:u}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),o=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,o,e):this.exponentialSearch(o,e)}binarySearch(e,t,o){let d=0,a=0;for(;e<=t;){if(d=e+Math.floor((t-e)/2),a=this.getSizeAndPositionForIndex(d).offset,a===o)return d;a<o?e=d+1:a>o&&(t=d-1)}return e>0?e-1:0}exponentialSearch(e,t){let o=1;for(;e<this.model.length&&this.getSizeAndPositionForIndex(e).offset<t;)e+=o,o*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.model.length-1),t)}}const ut=(()=>{let l=!1;try{const e=Object.defineProperty({},"passive",{get(){return l={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return l})();var mt=Me('<div><!> <div class="vtlist-inner"></div> <!></div>');function It(l,e){Ve(e,!0);const t=x(e,"model",19,()=>[]),o=x(e,"windowOverPaddingCount",3,3),d=x(e,"isHorizontal",3,!1),a=x(e,"scrollToAlignment",19,()=>Ee.AUTO),h=x(e,"scrollToBehaviour",19,()=>Ye.INSTANT),P=x(e,"class",3,""),u=x(e,"style",3,""),N=new ht(t(),e.sizeCalculator,e.estimatedItemSize);let se=J(0),p=J(0),U=!1,S,C=J(w([])),Q=J(w({offset:e.scrollToOffset||e.scrollToIndex!==void 0&&ee(e.scrollToIndex)||0,scrollChangeReason:Te.REQUESTED})),V={},H={scrollToIndex:e.scrollToIndex,scrollToAlignment:a(),scrollToOffset:e.scrollToOffset,sizeCalculator:e.sizeCalculator,estimatedItemSize:e.estimatedItemSize};const k=Y(()=>Pe("overflow:auto;",u())),$=Y(()=>{const{offset:c}=i(Q),m=N.getVisibleRangeOffsets(d()?i(p):i(se),c),E=m.startOffset,F=m.endOffset;return Pe("display:flex;",!d()&&"flex-direction:column;"||"flex-direction:row;",!d()&&`margin-top:${E}px;margin-bottom:${F}px`||`margin-left:${E}px;margin-right:${F}px;width:${N.getTotalSize()-F-E}px`)});ae(()=>{e.scrollToIndex,a(),e.scrollToOffset,e.sizeCalculator,e.estimatedItemSize,X()}),ae(()=>{const{offset:c,scrollChangeReason:m}=i(Q);(V.offset!==c||V.scrollChangeReason!==m)&&L(),V.offset!==c&&m===Te.REQUESTED&&B(c),V=i(Q)}),ae(()=>{i(se),i(p),U&&G(0)}),Ne(()=>{S.addEventListener("scroll",W,ut),e.scrollToOffset!==void 0?B(e.scrollToOffset):e.scrollToIndex!==void 0&&B(ee(e.scrollToIndex)),L(),U=!0}),Qe(()=>{U&&S.removeEventListener("scroll",W)});function X(){if(!U)return;e.scrollToIndex&&e.scrollToOffset&&console.log("VirtualList: scrollToIndex and scrollToOffset MUST NOT be used together.");const c=H.scrollToIndex!==e.scrollToIndex||H.scrollToAlignment!==a(),m=H.sizeCalculator!==e.sizeCalculator||H.estimatedItemSize!==e.estimatedItemSize;m&&(N.mutateState(e.sizeCalculator,t(),e.estimatedItemSize),G()),H.scrollToOffset!==e.scrollToOffset?O(Q,w({offset:e.scrollToOffset||0,scrollChangeReason:Te.REQUESTED})):typeof e.scrollToIndex=="number"&&(c||m)&&O(Q,w({offset:ee(e.scrollToIndex,a()),scrollChangeReason:Te.REQUESTED})),H={scrollToIndex:e.scrollToIndex,scrollToAlignment:a(),scrollToOffset:e.scrollToOffset,sizeCalculator:e.sizeCalculator,estimatedItemSize:e.estimatedItemSize}}function L(){const{offset:c}=i(Q);let{start:m,end:E}=N.getVisibleRangeIndex(d()?i(p):i(se),c,o()),F=[];if(m!==void 0&&E!==void 0){for(let f=m;f<=E;(f+=1)-1)F.push({item:t()[f],index:f});if(e.onVisibleRangeUpdate){const f=N.getVisibleRangeIndex(d()?i(p):i(se),c,0);e.onVisibleRangeUpdate({type:"range.update",start:f.start,end:f.end})}}O(C,w(F))}function B(c){if("scroll"in S){const m={behavior:h()};m[d()?"left":"top"]=c,S.scroll(m)}else S[d()?"scrollLeft":"scrollTop"]=c}function G(c=0){N.resetItem(c),L()}function ee(c,m=a()){return c<0?c=0:c>=t().length&&(c=t().length-1),N.getUpdatedOffsetForIndex(m,d()?i(p):i(se),i(Q).offset||0,c)}const W=c=>{const m=d()?S.scrollLeft:S.scrollTop;m<0||i(Q).offset===m||c.target!==S||(O(Q,w({offset:m,scrollChangeReason:Te.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:m,event:c}))};var I=mt();ye(I,c=>S=c,()=>S);var de=Ie(I);ne(de,()=>e.header,c=>{var m=_(),E=D(m);K(E,()=>e.header),A(c,m)});var oe=ce(de,2);ve(oe,21,()=>i(C),xe,(c,m)=>{var E=_(),F=D(E),f=qe(()=>({index:e.getKey?e.getKey(i(m).index):i(m).index,item:i(m).item,size:N.itemSizeAndPositionData[i(m).index].size}));K(F,()=>e.vl_slot,()=>i(f)),A(c,E)}),he(oe);var te=ce(oe,2);return ne(te,()=>e.footer,c=>{var m=_(),E=D(m);K(E,()=>e.footer),A(c,m)}),he(I),be(()=>{Ke(I,`vtlist $${P()??""}`),Oe(I,"style",i(k)),Oe(oe,"style",i($))}),De(I,"clientHeight",c=>O(se,c)),De(I,"clientWidth",c=>O(p,c)),A(l,I),ke({recomputeSizes:G})}var Ye=(l=>(l.AUTO="auto",l.SMOOTH="smooth",l.INSTANT="instant",l))(Ye||{}),Ee=(l=>(l.AUTO="auto",l.START="start",l.CENTER="center",l.END="end",l))(Ee||{}),Te=(l=>(l[l.OBSERVED=0]="OBSERVED",l[l.REQUESTED=1]="REQUESTED",l))(Te||{});export{Ae as A,Z as D,Je as S,vt as V,Tt as a,Ee as b,Ye as c,It as d};
