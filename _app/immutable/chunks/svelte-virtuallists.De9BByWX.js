var Ne=Object.defineProperty;var Be=(r,e,n)=>e in r?Ne(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n;var ee=(r,e,n)=>Be(r,typeof e!="symbol"?e+"":e,n);import{p as Me,a as y,s as Q,b as k,u as ze,o as De,c as Fe,g as i,d as R,e as be,i as K,f as ge,t as ye,h as z,j as Ve,k as Ee,l as ce,m as ve,n as Se,r as fe,q as ke,v as Ae,w as We,x as C,y as E,z as B,A as He,B as Pe,C as N,D as Qe,E as Re}from"./external.XxHSezL0.js";class je{constructor(e,n,o,f){ee(this,"model");ee(this,"modelCount");ee(this,"itemSize");ee(this,"estimatedItemSize");ee(this,"itemSizeAndPositionData");ee(this,"lastMeasuredIndex");ee(this,"totalSize");this.model=e,this.itemSize=o,this.modelCount=n,this.estimatedItemSize=f,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,n,o){n!==void 0&&(this.modelCount=n),o!==void 0&&(this.estimatedItemSize=o),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(this.model[e],e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.modelCount;n++){const o=this.getSize(n);this.itemSizeAndPositionData[n]={offset:e,size:o},e+=o}this.totalSize=e}getSizeAndPositionForIndex(e){if(e<0||e>=this.modelCount)throw Error(`Requested index ${e} is outside of range 0..${this.modelCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let o=n.offset+n.size;for(let f=this.lastMeasuredIndex+1;f<=e;f++){const l=this.getSize(f);if(l===void 0||isNaN(l))throw Error(`Invalid size returned for index ${f} of value ${l}`);this.itemSizeAndPositionData[f]={offset:o,size:l},o+=l}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=se.START,n,o,f){if(n<=0)return 0;const l=this.getSizeAndPositionForIndex(f),u=l.offset,b=u-n+l.size;let m;switch(e){case se.END:m=b;break;case se.CENTER:m=u-(n-l.size)/2;break;case se.START:m=u;break;default:m=Math.max(b,Math.min(u,o))}const W=this.getTotalSize();return Math.max(0,Math.min(W-n,m))}getVisibleRange(e=0,n,o){if(this.getTotalSize()===0)return{start:0,end:0};const l=n+e;let u=this.findNearestItem(n);if(u===void 0)throw Error(`Invalid offset ${n} specified`);const b=this.getSizeAndPositionForIndex(u);n=b.offset+b.size;let m=u;for(;n<l&&m<this.modelCount-1;)m++,n+=this.getSizeAndPositionForIndex(m).size;return o&&(u=Math.max(0,u-o),m=Math.min(m+o,this.modelCount-1)),{start:u,end:m}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),o=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch(0,o,e):this.exponentialSearch(o,e)}binarySearch(e,n,o){let f=0,l=0;for(;e<=n;){if(f=e+Math.floor((n-e)/2),l=this.getSizeAndPositionForIndex(f).offset,l===o)return f;l<o?e=f+1:l>o&&(n=f-1)}return e>0?e-1:0}exponentialSearch(e,n){let o=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=o,o*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),n)}}const qe=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var Ze=Ee('<div><!> <div class="virtual-list-inner svelte-f32i87"></div> <!></div>');function $e(r,e){Me(e,!0);const n=y(e,"width",3,"100%"),o=y(e,"model",19,()=>[]),f=y(e,"windowOverPadding",3,3),l=y(e,"scrollDirection",19,()=>w.VERTICAL),u=y(e,"scrollToAlignment",19,()=>se.AUTO),b=y(e,"scrollToBehaviour",19,()=>Oe.INSTANT),m=y(e,"class",3,"");y(e,"style",3,"");const W=We(e,["$$slots","$$events","$$legacy","height","width","model","modelCount","itemSize","estimatedItemSize","getKey","scrollToIndex","scrollOffset","windowOverPadding","scrollDirection","scrollToAlignment","scrollToBehaviour","footer","slot","header","onVisibleRangeUpdate","onAfterScroll","class","style"]),J={[w.VERTICAL]:"top",[w.HORIZONTAL]:"left"},Y={[w.VERTICAL]:"scrollTop",[w.HORIZONTAL]:"scrollLeft"},h=new je(o(),e.modelCount,e.itemSize,e.estimatedItemSize);let O=!1,V,Ie=Q(k([])),M=Q(k({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&re(e.scrollToIndex)||0,scrollChangeReason:de.REQUESTED})),D={},F={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},X={},j=Q(""),_=Q("");ze(()=>{e.scrollToIndex,u(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,oe()}),ze(()=>{const{offset:d,scrollChangeReason:c}=i(M);(D.offset!==d||D.scrollChangeReason!==c)&&G(),D.offset!==d&&c===de.REQUESTED&&p(d),D=i(M)}),ze(()=>{e.height,n(),O&&P(0)}),(()=>{if(l()===w.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical'");if(l()===w.HORIZONTAL&&typeof n()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal'");G()})(),De(()=>{V.addEventListener("scroll",le,qe),e.scrollOffset!==void 0?p(e.scrollOffset):e.scrollToIndex!==void 0&&p(re(e.scrollToIndex)),O=!0}),Fe(()=>{O&&V.removeEventListener("scroll",le)});function oe(){if(!O)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset MUST NOT be used together.");const d=F.scrollToIndex!==e.scrollToIndex||F.scrollToAlignment!==u(),c=F.modelCount!==e.modelCount||F.itemSize!==e.itemSize||F.estimatedItemSize!==e.estimatedItemSize;c&&(h.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),P()),F.scrollOffset!==e.scrollOffset?R(M,k({offset:e.scrollOffset||0,scrollChangeReason:de.REQUESTED})):typeof e.scrollToIndex=="number"&&(d||c)&&R(M,k({offset:re(e.scrollToIndex,u(),e.modelCount),scrollChangeReason:de.REQUESTED})),F={scrollToIndex:e.scrollToIndex,scrollToAlignment:u(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function G(){const{offset:d}=i(M);let{start:c,end:I}=h.getVisibleRange(l()===w.VERTICAL?e.height:n(),d,f()),U=[];const ie=h.getTotalSize(),ae=typeof e.height=="number"?"px":"",he=typeof n()=="number"?"px":"";if(l()===w.VERTICAL?(R(j,`height:${e.height}${ae};width:${n()}${he};`),R(_,`flex-direction:column;height:${ie}px;`)):(R(j,`height:${e.height}${ae};width:${n()}${he};`),R(_,`min-height:100%;width:${ie}px;`)),c!==void 0&&I!==void 0){for(let H=c;H<=I;(H+=1)-1)U.push({item:o()[H],index:H,style:Te(H)});if(e.onVisibleRangeUpdate){const H=h.getVisibleRange(l()===w.VERTICAL?e.height:n(),d,0);e.onVisibleRangeUpdate({type:"range.update",start:H.start,end:H.end})}}R(Ie,k(U))}function p(d){"scroll"in V?V.scroll({[J[l()]]:d,behavior:b()}):V[Y[l()]]=d}function P(d=0){X={},h.resetItem(d),G()}function re(d,c=u(),I=e.modelCount){return d<0?d=0:d>=I&&(d=I-1),h.getUpdatedOffsetForIndex(c,l()===w.VERTICAL?e.height:n(),i(M).offset||0,d)}const le=d=>{const c=V[Y[l()]];c<0||i(M).offset===c||d.target!==V||(R(M,k({offset:c,scrollChangeReason:de.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:c,event:d}))};function Te(d){if(X[d])return X[d];const{size:c,offset:I}=h.getSizeAndPositionForIndex(d);let U;return l()===w.VERTICAL?U=`left:0;width:100%;height:${c}px;position:absolute;top:${I}px;`:U=`top:0;width:${c}px;position:absolute;height:100%;left:${I}px;`,X[d]=U}var q=Ze();be(q,d=>V=d,()=>V);let xe;var ue=ve(q);K(ue,()=>e.header,d=>{var c=C(),I=E(c);B(I,()=>e.header),z(d,c)});var te=ce(ue,2);ge(te,21,()=>i(Ie),Se,(d,c)=>{var I=C(),U=E(I),ie=He(()=>({item:i(c).item,style:i(c).style,index:e.getKey?e.getKey(i(c).index):i(c).index}));B(U,()=>e.slot,()=>i(ie)),z(d,I)}),fe(te);var Ce=ce(te,2);return K(Ce,()=>e.footer,d=>{var c=C(),I=E(c);B(I,()=>e.footer),z(d,c)}),fe(q),ye(()=>{xe=ke(q,xe,{class:`virtual-list-wrapper $${m()??""}`,style:i(j),...W},"svelte-f32i87"),Ae(te,"style",i(_))}),z(r,q),Ve({recomputeSizes:P})}var Oe=(r=>(r.AUTO="auto",r.SMOOTH="smooth",r.INSTANT="instant",r))(Oe||{}),se=(r=>(r.AUTO="auto",r.START="start",r.CENTER="center",r.END="end",r))(se||{}),w=(r=>(r.HORIZONTAL="horizontal",r.VERTICAL="vertical",r))(w||{}),de=(r=>(r[r.OBSERVED=0]="OBSERVED",r[r.REQUESTED=1]="REQUESTED",r))(de||{});function we(r,e,n={}){n={start:0,end:r.length-1,maxTimes:1e3,...n};let o=n.start,f=n.end;const l=n.returnNearestIfNoHit,u=n.maxTimes;let b,m;o||(o=0,f=r.length-1);let W=0,J=0;for(;o>=0&&o<=f;){if(W>=u)throw Error(`binarySearch: loop times is over ${u}, you can increase the limit.`);b=Math.floor((f-o)/2+o),m=r[b];const Y=W+1;if(J=e(m,b,Y),J>0)f=b-1;else if(J<0)o=b+1;else return{index:b,value:m,count:Y,hit:!0};W++}return l?{index:b,value:m,count:W+1,hit:!1,greater:J>0}:null}const Ke=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var Je=Ee('<table class="vtlist-inner"><!><tbody><!></tbody></table> <!>',1),Ye=Ee('<div class="vtlist-inner"><!> <!> <!></div>'),Xe=Ee("<div><!></div>");function et(r,e){Me(e,!0);var n;(function(s){s[s.OBSERVED=0]="OBSERVED",s[s.REQUESTED=1]="REQUESTED"})(n||(n={}));const o=y(e,"items",19,()=>[]),f=y(e,"isDisabled",3,!1),l=y(e,"isHorizontal",3,!1),u=y(e,"isTable",3,!1),b=y(e,"preRenderCount",3,6);y(e,"scrollToAlignment",19,()=>se.AUTO);const m=y(e,"scrollToBehaviour",19,()=>Oe.INSTANT),W=y(e,"class",3,""),J=y(e,"style",3,"");let Y=!1,h,O,V=Q(0),Ie=Q(0),M=100,D=Q(0),F=Q(b()-1),X=Q(0),j=Q(k({offset:e.scrollOffset||e.scrollToIndex!==void 0&&1||0,scrollChangeReason:n.REQUESTED})),_;const oe=N(()=>{var t;const s=(((t=o())==null?void 0:t.length)||1)-1;return i(F)<s?i(F):s}),G=N(()=>new Array(o().length)),p=N(()=>o().map((t,a)=>{var v;const g=(v=e.sizingCalculator)==null?void 0:v.call(e,a,t);return typeof g=="number"?g:i(G)[a]!==null?i(G)[a]:i(X)})),P=N(()=>{const s=[];return i(p).reduce((t,a)=>(s.push(t),t+a),0),s}),re=N(()=>{if(!o()||f())return[];const s=[];for(let t=i(D);t<=i(oe);(t+=1)-1){console.log(t);const a=o()[t];if(!a)break;s.push({item:a,index:i(D)+t})}return s}),le=N(()=>i(P)[i(D)]?i(P)[i(D)]:0),Te=N(()=>i(P).length>0?i(P)[i(P).length-1]+i(p)[i(p).length-1]:0),q=N(()=>i(P)[i(oe)]?i(Te)-i(P)[i(oe)]-i(p)[i(oe)]:0),xe=N(()=>Re(!f()&&"overflow:auto;",J())),ue=N(()=>Re(!u()&&"display:flex;",!u()&&(!l()&&"flex-direction:column;"||"flex-direction:row;"),!f()&&(!l()&&`margin-top:${i(le)}px;margin-bottom:${i(q)}px`||`margin-left:${i(le)}px;margin-right:${i(q)}px;width:${i(Te)-i(q)-i(le)}px`)));De(()=>{h.addEventListener("scroll",te,Ke),Y=!0,c()}),Fe(()=>{Y&&h.removeEventListener("scroll",te)}),ze(()=>{const{offset:s,scrollChangeReason:t}=i(j);((_==null?void 0:_.offset)!==s||(_==null?void 0:_.scrollChangeReason)!==t)&&c(),(_==null?void 0:_.offset)!==s&&t===n.REQUESTED&&H(s),_=i(j)}),ze(()=>{var s;return(s=e.onVisibleRangeUpdate)==null?void 0:s.call(e,{type:"range.update",start:i(D),end:i(F)})});function te(s){var a;const t=ae(h);s.target!==h||t<0||i(j).offset===t||M-Math.abs(t-i(j).offset)>=1||(R(j,k({offset:t,scrollChangeReason:n.OBSERVED})),(a=e.onAfterScroll)==null||a.call(e,{type:"scroll.update",offset:t,event:s}))}function Ce(){const s=ae(h)-he(h)-M;return we(i(P),a=>a-s,{returnNearestIfNoHit:!0}).index}function d(){const s=ae(h)-he(h)+U(h)+M;return we(i(P),a=>a-s,{returnNearestIfNoHit:!0}).index}function c(){console.log("updatePositions"),i(X)||R(X,k(I())),R(D,k(Ce())),R(F,k(d()));let s=0;const t={},a=u()?O.querySelector("tbody").children:O.children;for(let g=0;g<a.length;(g+=1)-1){const v=a[g],A=getComputedStyle(v),T=A.position;if(T&&["absolute","fixed"].includes(T))continue;const S=A.display!=="none"?ie(v):0,x=i(D)+s;t[x]=(t[x]||0)+S,s+=1}for(const g of Object.keys(t)){const v=parseInt(g);i(G)[v]!==t[v]&&(i(G)[v]=t[v])}}function I(){const t=[],a=u()?O.querySelector("tbody").children:O.children;for(let g=0;g<a.length;(g+=1)-1){const v=a[g],A=getComputedStyle(v);if(["absolute","fixed"].includes(A.position))continue;const T=ie(v);if(t.push(T),t.length>=10)break}return t.length===0?0:t.reduce((g,v)=>g+v,0)/t.length}function U(s){const t=getComputedStyle(s);let a=parseFloat(l()?t.width:t.height);return t.boxSizing==="border-box"&&(l()?a-=parseFloat(t.borderLeftWidth)-parseFloat(t.borderRightWidth):a-=parseFloat(t.borderTopWidth)-parseFloat(t.borderBottomWidth)),a}function ie(s){const t=getComputedStyle(s);let a=U(s);return l()?a+=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)+parseFloat(t.marginLeft)+parseFloat(t.marginRight):a+=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)+parseFloat(t.marginTop)+parseFloat(t.marginBottom),Number.isNaN(a)?0:a}function ae(s){return l()?s.scrollLeft:s.scrollTop}function he(s){const t=getComputedStyle(s);return l()?parseFloat(t.paddingLeft):parseFloat(t.paddingTop)}function H(s){if("scroll"in h){const t={behavior:m()};t[l()?"left":"top"]=s,h.scroll(t)}else h[l()?"scrollLeft":"scrollTop"]=s}var $=Xe();be($,s=>h=s,()=>h);const Ue=N(()=>Re("vtlist",W()));var Le=ve($);K(Le,u,s=>{var t=Je(),a=E(t);be(a,S=>O=S,()=>O);var g=ve(a);K(g,()=>e.header,S=>{var x=C(),L=E(x);B(L,()=>e.header),z(S,x)});var v=ce(g),A=ve(v);K(A,f,S=>{var x=C(),L=E(x);ge(L,17,o,Se,(Z,ne)=>{var me=C(),_e=E(me);B(_e,()=>e.vl_slot,()=>i(ne)),z(Z,me)}),z(S,x)},S=>{var x=C(),L=E(x);ge(L,17,()=>i(re),Se,(Z,ne)=>{var me=C(),_e=E(me);B(_e,()=>e.vl_slot,()=>i(ne)),z(Z,me)}),z(S,x)}),fe(v),fe(a);var T=ce(a,2);K(T,()=>e.footer,S=>{var x=C(),L=E(x);B(L,()=>e.footer),z(S,x)}),ye(()=>Ae(a,"style",i(ue))),z(s,t)},s=>{var t=Ye();be(t,A=>O=A,()=>O);var a=ve(t);K(a,()=>e.header,A=>{var T=C(),S=E(T);B(S,()=>e.header),z(A,T)});var g=ce(a,2);K(g,f,A=>{var T=C(),S=E(T);ge(S,17,o,Se,(x,L)=>{var Z=C(),ne=E(Z);B(ne,()=>e.vl_slot,()=>i(L)),z(x,Z)}),z(A,T)},A=>{var T=C(),S=E(T);ge(S,17,()=>i(re),Se,(x,L)=>{var Z=C(),ne=E(Z);B(ne,()=>e.vl_slot,()=>i(L)),z(x,Z)}),z(A,T)});var v=ce(g,2);K(v,()=>e.footer,A=>{var T=C(),S=E(T);B(S,()=>e.footer),z(A,T)}),fe(t),ye(()=>Ae(t,"style",i(ue))),z(s,t)}),fe($),ye(()=>{Qe($,i(Ue)),Ae($,"style",i(xe))}),Pe($,"clientHeight",s=>R(V,s)),Pe($,"clientWidth",s=>R(Ie,s)),z(r,$),Ve()}export{se as A,w as D,Oe as S,et as V,$e as a};
